module CubatureB
# routines for constructing cubatures on asymmetric nodes

using LinearAlgebra
using LeastSquaresOptim
using ..OrthoPoly
using ..AsymCubatures
using ..Optimizer

export getTriCubatureDiagE
export getTetCubatureDiagE

"""
### CubatureB.cubatureresidual

This method computes the residuals, `F`, between a cubature, defined by `cub`,
and the true value of an integral.  Each residual corresponds with an orthogonal
polynomial on the simplex up to degree `q`.  The Jacobian, `dF`, of the
residual, with respect to the quadrature nodes and weights, is also returned.

**Inputs**

* `cub`: defines the nodes and weights of the assymetric cubature
* `q`: maximum degree of the othogonal polynomials used in the conditions
* `calc_grad`: indicates whether to calculate the gradients the orthogonal polynomials

**Outputs**

* `F`: the accuracy conditions for orthogonal polynomials up to degree q
* `dF`: derivative of F with respect to x, y, (z,) w, in that order

"""
function cubatureresidual(cub::LineAsymCub{T}, q::Int; compute_grad=true) where {T}
  # compute the nodes and weights defined by cub
  vtx = reshape(T[-1; 1], (2,1))
  x = AsymCubatures.calcnodes(cub)
  w = AsymCubatures.calcweights(cub)
  num_eq = convert(Int, q+1)
  # loop over orthogonal polynomials of degree r <= q and form conditions
  F = zeros(T, (num_eq) )
  F[1] = -2.0/sqrt(2.0)
  dF = zeros(T, (num_eq, 2*cub.numnodes) )
  ptr = 1
  for r = 0:q
    P = OrthoPoly.jacobipoly(vec(x), 0.0, 0.0, r)
    F[ptr] += (w'*P)[1]
    if compute_grad
      dPdx = OrthoPoly.diffjacobipoly(vec(x[1,:]), 0.0, 0.0, r)
      dF[ptr,:] = [w.*dPdx P]
    end
    ptr += 1
  end
  return F, dF 
end

function cubatureresidual(cub::TriAsymCub{T}, q::Int; compute_grad=true) where {T}
  # compute the nodes and weights defined by cub
  vtx = T[-1 -1; 1 -1; -1 1]
  x = AsymCubatures.calcnodes(cub)
  w = AsymCubatures.calcweights(cub)
  num_eq = convert(Int, (q+1)*(q+2)/2)

  # loop over orthogonal polynomials of degree r <= q and form conditions
  F = zeros(T, (num_eq) )
  F[1] = -2.0/sqrt(2.0)
  dF = zeros(T, (num_eq, 3*cub.numnodes) )

  V, Vdx, Vdy = OrthoPoly.vandermonde(q, x[1,:], x[2,:], compute_grad=compute_grad)
  F = V'*w + F

  if compute_grad
    dF = [Vdx'*Diagonal(w) Vdy'*Diagonal(w) V']
  end
  return F, dF 
end

function cubatureresidual(cub::TetAsymCub{T}, q::Int; compute_grad=true) where {T}
  # compute the nodes and weights defined by cub
  vtx = T[-1 -1 -1; 1 -1 -1; -1 1 -1; -1 -1 1]
  x = AsymCubatures.calcnodes(cub)
  w = AsymCubatures.calcweights(cub)
  num_eq = convert(Int, (q+1)*(q+2)*(q+3)/6)
  # loop over orthogonal polynomials of degree r <= q and form conditions
  F = zeros(T, (num_eq) )
  F[1] = -2.0/sqrt(3.0)
  dF = zeros(T, (num_eq, 4*cub.numnodes) )
  ptr = 1
  for r = 0:q
    for k = 0:r
      for j = 0:r-k
        i = r-j-k
        P = OrthoPoly.proriolpoly(vec(x[1,:]), vec(x[2,:]), vec(x[3,:]), i, j, k)
        F[ptr] += (w'*P)[1]
        if compute_grad
          dPdx, dPdy, dPdz = OrthoPoly.diffproriolpoly(vec(x[1,:]), vec(x[2,:]),vec(x[3,:]), i, j, k)
          dF[ptr,:] = [w.*dPdx w.*dPdy w.*dPdz P]
        end
        ptr += 1
        #print("(i,j,k) = (",i,",",j,",",k,"): i+j+k = ",i+j+k,"\n")
      end
    end
  end
  return F, dF 
end

"""
### Cubature.solvecubature!{SymCub{T}}
  
Attempts to solve for the nodes and weights of a cubature that is exact for
polynomials of degree r <= `q`.  The nodes and weights of the cubature are
defined by `cub`, which is a parametric abstract type (see symcubatures.jl).

**Inputs**

* `cub`: symmetric cubature rule
* `q`: maximum (desired) degree for which the cubature is exact
* `mask`: array of indicies of parameters and weights that are free
* `tol`: tolerance with which to solve the accuracy conditions
* `hist`: if true, print the residual-norm convergence history
* `xinit`: initial parameter guess
* `delta1`: purturbation constant that determines how much the parameters are perturbed
            in the case of stagnation with fmin <= 0.1
* `delta2`: purturbation constant that determines how much the parameters are perturbed
            in the case of stagnation with fmin > 0.1

**In/Outs**

* `cub`: on entry, defines the initial guess for the cubature nodes and weights.
  on exit, defines the nodes and weights that satisfy the desired accuracy.

"""
function solvecubature!(cub::AsymCub{T}, q::Int, mask::AbstractArray{Int64,1};
  tol=10*eps(typeof(real(one(T)))),hist::Bool=false, verbose::Bool=false, xinit=[],
  delta1::Float64=1e-2, delta2::Float64=1e-2) where {T}
  @assert( length(mask) <= cub.numparams + cub.numweights )

  # Particle Swarm Optimization 
  n = cub.numparams + cub.numweights
  v = zeros(T, n)
  v[1:cub.numparams] = cub.params
  v[cub.numparams+1:end] = cub.weights
  # xinit=[]
  if xinit==[]
    xinit = copy(v)
  end
  nperturb = 0
  k=0
  v1 = copy(v)
  v2 = copy(v)
  
  if xinit!=[]
    AsymCubatures.setweights!(cub, xinit[cub.numparams+1:end])
    xinit[1:cub.numparams] = cub.params
    xinit[cub.numparams+1:end] = cub.weights
  end

  nperturb_all = 0
  iter_pso = 0
  iter_lma = 0
  # fmin,xinit,k = Optimizer.levenberg_marquardt(CubatureB.cubatureresidual,cub,q,mask, xinit=xinit, maxiter=200, tol=tol, nu=10.0, verbose=0)
  # iter_lma+=k

  # println(fmin)
  # println(xinit)

  fbest = 1.0
  xbest = copy(v)
  # verbose=true
  for i = 1:5000
    fmin1,v1,_,_,k_pso,nperturb = Optimizer.pso(CubatureB.cubatureresidual, n, cub, q, mask,xinit=xinit, np=10,maxiter=200, 
                                            tol=tol, delta1=delta1, delta2=delta2, save_iter=false,verbose=verbose)
    fmin2,v2,k_lma = Optimizer.levenberg_marquardt(CubatureB.cubatureresidual,cub,q,mask, xinit=v1, maxiter=200, tol=tol, nu=1000.0, verbose=verbose)

    iter_pso += k_pso
    iter_lma += k_lma
    nperturb_all += nperturb

    use_v2 = false
    fmin3,_,_,_,_,_ = Optimizer.pso(CubatureB.cubatureresidual, n, cub, q, mask,xinit=v2, np=10, maxiter=100, 
                                            tol=tol, delta1=delta1, delta2=delta2, save_iter=false,verbose=false)
    if (fmin3 < fmin1)
      use_v2 = true
    end

    if use_v2
      xinit = v2
    else
      xinit = v1
    end

    if (fbest < 1.0 && fmin2-fbest > 0.10 && fmin1-fbest > 0.10)
      xinit = xbest
    elseif use_v2 
      xbest = v2
      fbest = fmin2
    else
      xbest = v1
      fbest = fmin1
    end

    if (fmin2<1e-12||fmin1<1e-12) && (minimum(v2[end-cub.numweights+1:end])>1e-10)
      if verbose
        println(v2)
      end
      break
    end
    if verbose
      println(v2)
    end
  end
  v = v2

  AsymCubatures.setweights!(cub, v[cub.numparams+1:end])
  F, _ = CubatureB.cubatureresidual(cub, q)
  res = norm(F)
  # hist ? print("\titer ",k, ":  nrestart ",nrestart,":  res norm = ",res,"\n") : nothing
  hist ? println("----------------------------------------------------------------------------------------------") : nothing
  hist ? println("iter_pso = ",iter_pso, ":  iter_lma = ",iter_lma, ":  nperturb_pso = ",nperturb_all,":  res norm = ",res) : nothing
  hist ? println("----------------------------------------------------------------------------------------------") : nothing
  # hist ? print("res norm = ",res,"\n") : nothing
  if res < tol
    return
  end

end

"""
### CubatureB.solvecubatureweights!{AsymCub{T}}
  
Attempts to solve for the weights of a cubature that is exact for
polynomials of degree r <= `q`.  The weights (and nodes) of the cubature are
defined by `cub`, which is a parametric abstract type (see symcubatures.jl).

**Inputs**

* `q`: maximum (desired) degree for which the cubature is exact
* `tol`: tolerance with which to solve the accuracy conditions
* `hist`: if true, print the residual-norm convergence history

**In/Outs**

* `cub`: on entry, defines the initial guess for the cubature nodes and weights.
  on exit, defines the nodes and weights that satisfy the desired accuracy.

"""
function solvecubatureweights!(cub::AsymCub{T}, q::Int;
                                  tol=10*eps(typeof(real(one(T)))),
                                  hist::Bool=false) where {T}
  Jac = AsymCubatures.calcjacobianofweights(cub)

  # compute accuracy for initial guess 
  F, dF = CubatureB.cubatureresidual(cub, q, compute_grad=true)
  res = norm(F)
  res0 = res
  res_old = res
  hist ? print("solvecubatureweights!:\n") : nothing
  hist ? print("\titer ",0,": res norm = ",res,"\n") : nothing
  if (res < tol)
    return
  end
  
  # Levenbergâ€“Marquardt loop
  maxiter = 200
  nu = 1000.0 #100.0
  v = zeros(T, (cub.numweights) )
  v = cub.weights
  for k = 1:maxiter
    JtJ = Jac'*(dF[:,end-cub.numnodes+1:end]'*
      dF[:,end-cub.numnodes+1:end])*Jac
    H = JtJ + nu*diagm(diag(JtJ))
    g = -Jac'*dF[:,end-cub.numnodes+1:end]'*F
    dv = H\g

    # update cubature definition and check for convergence
    v += dv
    AsymCubatures.setweights!(cub, v)
    F, dF = CubatureB.cubatureresidual(cub, q)
    res = norm(F)
    hist ? print("\titer ",k,": res norm = ",res,"\n") : nothing
    if res < tol
      #println("size(JtJ) = ",size(JtJ))
      #println("rank(JtJ) = ",rank(JtJ))
      return
    end

    # trust-region like update
    if res > res_old
      v -= dv
      AsymCubatures.setweights!(cub, v)
      F, dF = CubatureB.cubatureresidual(cub, q)
      nu *= 4.0
    else
      nu /= 2.0
      res_old = res
    end

  end
  error("solvecubatureweights failed to find solution in ",maxiter," iterations")
end


"""
### Cubature.getTriCubatureDiagE{T}

Returns a cubature rule and vertices for the SBP DiagE operators on triangles;
these are cubatures that have nodes on the boundary that correspond with LG or
LGL quadrature rules, which then leads to diagonal E.

**Inputs**

* `q`: maximum degree of polynomial for which the cubature is exact
* `T`: the data type used to represent the cubature
* `vertices`: if true then vertices are included
* `tol`: tolerance with which to solve the cubature

**Outputs**

* `cub`: a symmetric cubature for the right triangle
* `vtx`: vertices for the right triangle

"""
function getTriCubatureDiagE(q::Int, T=Float64; vertices::Bool=true,
                             tol=10*eps(typeof(real(one(T)))))
  cub_degree = q
  mask = zeros(Int64, (0))
  # include the vertices in the cubature
  if q<=1 #6 nodes
    edgeparams = T[-1.0, 0.0, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.0070731278656722, 0.004242931449819557, 0.6631052021428209, 1.3149441461521694, 0.002879997597872101, 0.007754594791645942])
    cub_degree = 1
    tol = tol
  elseif q<=2 #10 nodes
    edgeparams = T[-1.0, -0.3333333333333334, 0.3333333333333334, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.07198512251367098, 0.13252388075373112, 0.08758333163905326, 0.0696206170787101, 0.15152075170525584, 1.0597855752144316, 0.20355481712481674, 0.06858646068752829, 0.01655239526796775, 0.13828704801483457])
    cub_degree = 2
    tol = tol
  elseif q<=3 #15 nodes
    edgeparams = T[-1.0, -0.5, 0.0, 0.5, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.07893470245415034, 0.012197732483699462, 0.21750517869725466, 0.0007804057879078453, 0.08496327024554591, 0.027619013255254586, 0.3283964451543922, 0.3626484252417672, 0.014922068785463982, 0.19437325753992202, 0.3756217962705075, 0.1962926842009205, 0.011877229549882812, 0.010597611775883824, 0.08327017855744723])
    cub_degree = 3
    tol = tol
  elseif q<=4 #21 nodes
    edgeparams = T[-1.0, -0.6000000000000001, -0.19999999999999996, 0.19999999999999996, 0.6000000000000001, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.023841964112535266, 0.03998980776562836, 0.04167127518517384, 0.07017064251054726, 0.024890041771643362, 0.028416275679014842, 0.049133705005028415, 0.45114266301158307, 0.011696469135058594, 0.4545429923367763, 0.041361913166615645, 0.023383480706373753, 0.00603398079201118, 0.0009334868042215118, 0.03722689972060286, 0.09034593310369657, 0.4583179845654745, 0.07820267875206408, 0.01385864841789415, 0.01993027559371044, 0.034908881864345744])
    cub_degree = 4
    tol = tol
  elseif q<=5 #28 nodes
    edgeparams = T[-1.0, -0.6666666666666667, -0.3333333333333334, 0.0, 0.3333333333333334, 0.6666666666666667, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.013916537183261263, 0.03904593409890653, 0.04232176171690407, 0.0496457244799474, 0.005244202960274393, 0.04407539685757546, 0.018410153860082806, 0.04888341423009719, 0.19155537750023052, 0.053204351121113026, 0.20151458614763162, 0.2405631812201453, 0.016892251410499038, 0.01772806138892739, 0.2493991795927117, 0.003635879811169043, 0.0030733371263637257, 0.07320206657796541, 0.01703904876005, 0.005319757676032698, 0.2516456001423809, 0.0251823226634487, 0.0787479168680972, 0.21437446394793605, 0.011059000823961156, 0.01991165474888815, 0.046987221166542595, 0.01742161591885677])
    cub_degree = 5
    tol = tol
  elseif q<=6 #36 nodes
    edgeparams = T[-1.0, -0.7142857142857144, -0.4285714285714286, -0.14285714285714285, 0.14285714285714285, 0.4285714285714286, 0.7142857142857144, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.005548199497735285, 0.039918644483854446, 0.0058544086434301704, 0.035448427490905335, 0.026541218240718475, 0.011436848202807064, 0.037042834823330165, 0.006333712048885369, 0.0395309960690353, 0.19114042692112362, 0.011836378013837362, 0.26245808374017077, 0.010645807967513151, 0.19723040576551565, 0.03690821787150904, 0.00701735388788758, 0.026400517646316544, 0.019329933176884327, 0.021711073269532144, 0.012366140581660929, 0.011840699058270536, 0.028655472205983176, 0.2430392308968651, 0.03835714170173217, 0.2601643069213073, 0.02529468927689684, 0.03818888673646707, 0.016886913383892407, 0.004043106365560999, 0.037268400659442785, 0.003200026022082059, 0.19806317728540393, 0.006321079071963007, 0.039649646963590475, 0.03860929594696352, 0.005718299160926123])
    cub_degree = 6
    tol = tol
  elseif q<=7 #55
    edgeparams = T[-1.0, -0.7777777777777777, -0.5555555555555556, -0.3333333333333334, -0.11111111111111116, 0.11111111111111116, 0.3333333333333334, 0.5555555555555556, 0.7777777777777777, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.006350058008792387, 0.015223583470636527, 0.025371228135739644, 0.00010616287640091057, 0.025383533800355636, 0.010783147714366231, 0.010478572995137794, 0.021243012369241854, 0.012847465773813788, 0.006539856811847466, 0.020246116569416422, 0.08813597442085336, 0.05650027318858042, 0.038453046349298727, 0.15104039381137233, 0.03707285363075561, 0.05312155348172036, 0.11380827240683664, 0.01905468078249483, 0.00949025166360028, 0.08818232725519999, 0.018184867821309427, 0.0047821681398005755, 0.0021008408113561004, 0.030189229693227095, 0.008442766652831458, 0.009653840404086123, 0.01677972613556574, 1.1097644051160594e-5, 0.020829195194369616, 0.18595068539322523, 0.009971872405216891, 0.1381525098684017, 0.021520297694470728, 0.018485181961353042, 0.15991661688065764, 0.011103005680663539, 0.015491708800884586, 0.006102704492548319, 0.012359034204477943, 0.013635288923076942, 0.041273491886045524, 0.006446513779916153, 0.15440923521781563, 0.012317318220453455, 0.006907269381332015, 0.05649407004740025, 0.0040061510468294755, 0.015761210807637843, 0.023056170443032365, 0.11601627056507456, 0.01467794008828708, 0.01168908338721833, 0.016804130518935704, 0.0070461402919865706])
    cub_degree = 7
    tol = tol
  elseif q<=8 #91
    edgeparams = T[-1.0, -0.8333333333333333, -0.6666666666666667, -0.5, -0.3333333333333334, -0.16666666666666674, 0.0, 0.16666666666666674, 0.3333333333333334, 0.5, 0.6666666666666667, 0.8333333333333333, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.001626607699900398, 0.014426688408051395, 0.0019323901123186977, 0.010323288726617879, 0.00960541216257016, 0.009365448478674949, 0.005352321776651005, 0.007924910665288649, 0.01029343750783684, 0.010500000102264269, 0.002513270900580659, 0.01386716274248343, 0.0017593217874651763, 0.014498085935959826, 0.057990230898961756, 0.020957650821187147, 0.05466370152950565, 0.04217760465199647, 0.036743942450097676, 0.03869649904341939, 0.04224657494241408, 0.05366389565255565, 0.018568060235765606, 0.05937956130236004, 0.014281184631005243, 0.0018319620163190636, 0.018414628728858146, 0.003921542402508304, 0.019952503346525766, 0.013919352262343764, 0.001302828970772072, 0.015003303902508454, 0.02183164677980709, 0.005382873023398331, 0.01917470017170849, 0.0015046141875735594, 0.010998365114107487, 0.05668796122170574, 0.021602097036504266, 0.04306045484396517, 0.04099028456285945, 0.03720678130692895, 0.043667593756505245, 0.02066746298198628, 0.05486995281260074, 0.011121792247701136, 0.009304024855099128, 0.04136334114821831, 0.013629235870494411, 0.033043985992095515, 0.02957712207937325, 0.026862481730392768, 0.012487419632476394, 0.04177884788422633, 0.010425034335464683, 0.008811756456739319, 0.036875640587972755, 0.0043056464401470314, 0.03735895533716158, 0.02869384764343516, 0.02226485067829232, 0.034281307524498796, 0.007028340752476605, 0.005030758936215655, 0.03787497786151611, 0.014818375024198024, 0.04544354694304592, 0.007043395344033593, 0.035846099898175054, 0.007764708845084531, 0.009839601275621475, 0.04153804690175957, 0.022632928942609723, 0.023001816318676097, 0.04265014065920291, 0.007989154528765568, 0.009312498865399019, 0.05419312804938967, 0.002882476238825076, 0.054930252682805596, 0.00923530226770258, 0.009679651296857649, 0.018909298598048255, 0.01914143053810156, 0.011301969212797004, 0.003681099404042702, 0.05970271639845532, 0.0018646265565589843, 0.013229883909594974, 0.013983246820838085, 0.0019170738899948812])
    cub_degree = 8
    tol = tol
    #105
    # edgeparams = T[-1.0, -0.8461538461538463, -0.6923076923076923, -0.5384615384615383, -0.3846153846153846, -0.23076923076923078, -0.07692307692307687, 0.07692307692307687, 0.23076923076923078, 0.3846153846153846, 0.5384615384615383, 0.6923076923076923, 0.8461538461538463, 1.0]
    # cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    # AsymCubatures.setparams!(cub, edgeparams)
    # AsymCubatures.setweights!(cub, T[0.0017397641825765754, 0.011117699176624309, 0.0028597891566883127, 0.009884493461747312, 0.005057099107788299, 0.009243851577641836, 0.005771952089894501, 0.006954652776546228, 0.007627196225204572, 0.005363641405921888, 0.011593773706003691, 0.0008644328815737935, 0.012176852422272537, 0.001653950857553281, 0.01123183421078475, 0.05184876778522166, 0.015438857351994937, 0.05091353536465654, 0.028426339650743353, 0.03696412151145829, 0.034444039984866996, 0.0375717555557475, 0.026457459488589765, 0.05383250452215794, 0.013954102047377553, 0.05088794336100105, 0.010966391396363748, 0.0035998999775321634, 0.011330673719601449, 0.0035292075074874227, 0.015687187473443154, 0.00874290974944727, 0.010287781970429325, 0.005265814439194853, 0.006745655534957098, 0.018878167168678517, 0.000936497160699952, 0.015922804686096106, 0.0035402123763382596, 0.007738179366937289, 0.05694164893344307, 0.015346419099173048, 0.05179475894591307, 0.025734010970851907, 0.037608366835280384, 0.03310321871468184, 0.04965017670779083, 0.016245921428209267, 0.05257193240361806, 0.009069945751277496, 0.007981435609090825, 0.02534094305806483, 0.007043576173764889, 0.023703873893014323, 0.01295924057061656, 0.027968172550481726, 0.016617682243992044, 0.003994538831469488, 0.026993852424997987, 0.0041740083118944485, 0.006693237054803479, 0.03791567081555314, 0.011633531540964987, 0.0376284401965981, 0.018474590426291577, 0.02633259399949523, 0.022003248646571414, 0.041470369444355386, 0.010928818005244319, 0.007447136112157481, 0.03202107352748891, 0.009443277236627367, 0.03457308653610251, 0.016218527532371296, 0.02223658192701742, 0.02183366437361384, 0.005804688310907112, 0.005950548667986068, 0.037843880426877696, 0.007749180286605096, 0.049195708890732534, 0.007613702632962838, 0.036500339419424904, 0.006846168794274033, 0.008511511678525365, 0.026747770814384942, 0.015458354833266222, 0.01612557468114999, 0.030328985507826034, 0.00794061620141232, 0.005721503913495093, 0.052595051750830006, 0.002547485276206463, 0.050627679644423565, 0.00656443503852946, 0.010294056035455239, 0.015356572451509239, 0.015377758083346809, 0.009831389963992397, 0.0019351878872121264, 0.0508464836573645, 0.001958541633566866, 0.01161146292023479, 0.01173860061367742, 0.0016273967610943452])
    # cub_degree = 8
    # tol = tol
    #120
    # edgeparams = T[-1.0, -0.8571428571428572, -0.7142857142857144, -0.5714285714285714, -0.4285714285714286, -0.2857142857142858, -0.14285714285714285, 0.0, 0.14285714285714285, 0.2857142857142858, 0.4285714285714286, 0.5714285714285714, 0.7142857142857144, 0.8571428571428572, 1.0]
    # cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    # AsymCubatures.setparams!(cub, edgeparams)
    # AsymCubatures.setweights!(cub, T[0.001561988712227779, 0.008992610222645532, 0.00668691989979774, 0.006830678305856886, 0.006131848487094128, 0.0024158185735181077, 0.011096177820598675, 0.004617062916664337, 0.0054610124201489516, 0.006703353142327388, 0.0034512344586329464, 0.0073401816102386455, 0.005999942709416182, 0.010351844567331308, 0.0006936943016933513, 0.01055449459487873, 0.03591601656574318, 0.017851849119024307, 0.008774834962141232, 0.06646527842864033, 0.01653411252806694, 0.017188320161711904, 0.041031599496424646, 0.02276471531682383, 0.04459861364536548, 0.029277084277205764, 0.01099472715495273, 0.035636645979497124, 0.01254982059494924, 0.003628197959405917, 0.02389766561534118, 0.03479385454582908, 0.0007783759088717666, 0.008907675847281507, 0.017037960232213666, 0.010306762116365616, 0.009470805594794341, 0.006795965527431177, 0.02763267258737974, 0.008740092626872194, 0.031045719385277275, 0.0010883823772763227, 0.003724705972990276, 0.019847774379423005, 0.012833758361070494, 0.006020757232507284, 0.053071944601066096, 0.015358013356912625, 0.01523479755065626, 0.00699170116134487, 0.02085442259150849, 0.006722147423112498, 0.01650434980661174, 0.0077886062942883645, 0.013813341954773621, 0.03009434460748029, 0.022022082615913856, 0.024556691340728586, 0.018984776598726553, 0.015034148884620775, 0.04434141377351863, 0.04459823803107682, 0.010662617607860405, 0.0617054918294709, 9.121335827048908e-6, 0.003948629034929417, 0.019526417801392134, 0.016852998002096494, 0.009450583099648312, 0.03596715997298147, 0.04137783655576128, 0.004552229786763839, 0.01562393661562872, 0.015242984737130824, 0.008425479862138981, 0.0031114214190797024, 0.05953238016172287, 0.006744751514891237, 0.017209276769581686, 0.011139420109241745, 0.003559723057548388, 0.0061140711427735105, 0.008047089189138637, 0.01736714448495246, 0.006501046270833808, 0.004512771251269277, 0.009105372676336806, 0.015508955154936645, 0.012438598940396676, 0.048361267873468665, 0.0260631406073798, 0.0012644745754301335, 0.009985062880555274, 0.02037766603061245, 0.06177072721618188, 0.0024289735068637667, 0.015111297545628958, 0.050931601572039166, 0.002942924823262947, 0.002615385605773101, 0.027504420632206664, 0.03259526752615124, 0.015871621211509822, 0.021554509020436357, 0.0023078174232146554, 0.012792260214980242, 0.01647826328952804, 0.009143355966803232, 0.018481235551881373, 0.014140076067062609, 0.008310016025268499, 0.011769817024374699, 0.016919304278103075, 0.00486505969655741, 0.004630161305725589, 0.05565151201018073, 0.008225267323083823, 0.005187098467312656, 0.0029201529383827626, 0.0035681255694186647])
    # cub_degree = 8
    # tol = tol
  elseif q<=9 #153
    edgeparams = T[-1.0, -0.875, -0.75, -0.625, -0.5, -0.375, -0.25, -0.125, 0.0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.0014539588150219549, 0.006808611630147894, 0.0011820278896471452, 0.008551362388027766, 0.0017355918278561834, 0.005592060674193727, 0.004228062126841254, 0.004863042793444883, 0.004592533076503938, 0.004774323908285766, 0.004080430844137447, 0.005699539476882076, 0.0018105783090662192, 0.008533213620742244, 0.0010054390375036336, 0.006947906650370858, 0.0014174738751287026, 0.006827406027804711, 0.036759469651654615, 0.006455910435504122, 0.041955270319613894, 0.010978837406195265, 0.030782033041477586, 0.021785265319408845, 0.02422831157007216, 0.023619574883804253, 0.022598047489725194, 0.03059113727151058, 0.010059799678856014, 0.0430238427120643, 0.006603388537987405, 0.036471209874464706, 0.006893911203480236, 0.0012001242267714895, 0.006151822405226806, 0.0008573586498351255, 0.007301319174112045, 0.0014696518063613004, 0.005192650703133628, 0.0026007613138098943, 0.003753649157530657, 0.003767096509266393, 0.005272684799157771, 0.0017673492480272711, 0.006348305249707229, 2.2971211693125317e-5, 0.006318681807355121, 0.0013026628552278315, 0.008449792177203505, 0.04233861033761771, 0.007229275962173308, 0.04905817959162444, 0.011465706605041441, 0.0381589378413759, 0.025313826632268645, 0.027687713864268913, 0.03586862773040276, 0.01175329417405088, 0.05053772588198579, 0.007215672773847913, 0.04348353713313574, 0.008030286368250771, 0.0019309366750197346, 0.010954407665756845, 0.001772801379594554, 0.011389293375569735, 0.0033337331602916807, 0.008081313935526226, 0.00587952268480672, 0.004457419034277614, 0.0020273215409142183, 0.011538704814866166, 0.001960118201846428, 0.009722088121636472, 0.001874529668680996, 0.005389662541195752, 0.03044529370493511, 0.004757019074384876, 0.0378766771064208, 0.008233503923368303, 0.02544075322965714, 0.018206633733717423, 0.018534108225237052, 0.037618728006099146, 0.00562560920561355, 0.030216116281336875, 0.0062412567247187795, 0.004232929698715006, 0.021811301322698744, 0.003655512711867447, 0.026125397758080968, 0.004868747960786953, 0.01835067025084679, 0.013350559664038607, 0.014596590659922507, 0.003421467113609116, 0.021030554509407245, 0.003942146231154093, 0.005229082099442188, 0.023737245032639027, 0.002636407430720015, 0.02829816255008747, 0.003832723047103687, 0.020181464183023842, 0.014601535897080319, 0.01227016028472884, 0.02401318561261361, 0.004960983618708739, 0.00435368202275585, 0.02473372091035522, 0.0032029818728324068, 0.03580769106519023, 0.002242925225490213, 0.03578426715846445, 0.0036998018822813447, 0.023887828723182104, 0.004612514929940253, 0.004603653513040273, 0.02245204876711208, 0.005187718514635245, 0.011957249029690607, 0.012033936658623033, 0.005337460054158288, 0.02187218474920468, 0.004237786852009791, 0.004142625315770181, 0.030751153338988858, 0.001812926632251895, 0.051664341262136544, 0.00125453568081802, 0.030357614767810903, 0.004619236162866477, 0.005576611586757795, 0.010105959714422725, 0.004812707038590572, 0.007405936120000868, 0.009723619381564526, 0.005683722040792061, 0.0020278581711794716, 0.043257682748633515, 0.001175766283520243, 0.04291687464539009, 0.0019364488066236122, 0.008383782290250913, 0.006133263654076044, 0.0062506455657737, 0.008505981233592926, 0.00109919169670474, 0.0366645166408072, 0.0009610758736587635, 0.006902257255528796, 0.006970000041230536, 0.0014139859106557435])
    cub_degree = 9
    tol = tol
  elseif q<=10 #171
    edgeparams = T[-1.0, -0.8823529411764706, -0.7647058823529411, -0.6470588235294117, -0.5294117647058822, -0.41176470588235287, -0.2941176470588236, -0.17647058823529416, -0.05882352941176472, 0.05882352941176472, 0.17647058823529416, 0.2941176470588236, 0.41176470588235287, 0.5294117647058822, 0.6470588235294117, 0.7647058823529411, 0.8823529411764706, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.0007509821196202235, 0.007302758388588854, 0.0013247524404740054, 0.004152119153893176, 0.005817277965524546, 0.0040159268126411535, 0.003895016980758349, 0.0027245739487663447, 0.005016350873177284, 0.005751062888664863, 0.0035573439467550282, 0.0025479610119303582, 0.004829815679182238, 0.005588186528058312, 0.004085643160701326, 0.0013088783729850997, 0.0072975762110719985, 0.0007982843989014975, 0.007490932905168272, 0.02764556062501695, 0.011653221384243304, 0.023858622638356308, 0.02491185895392844, 0.017371176125437548, 0.015321123209063564, 0.020470051782370328, 0.02565645059541974, 0.021559002544238513, 0.013712169182465012, 0.016824755574641664, 0.026077315141915042, 0.023913113171403762, 0.011701533818761805, 0.0277405035876622, 0.007190093574465824, 0.0009051387713402714, 0.011509297550840231, 0.003074357472483947, 0.009557970206023551, 0.010200182470171527, 0.00520213815740743, 0.0058813752236775005, 0.009957892677674962, 0.011780442059069519, 0.00694840881094902, 0.005531222373429016, 0.009578727113939832, 0.009990433872863124, 0.001565836207331636, 0.01217652403901382, 0.001449620774539636, 0.004551415350092029, 0.02477570015286422, 0.009392494087567975, 0.016275963259363986, 0.01754062616552936, 0.01563411270203011, 0.01467719519823168, 0.015099085440222496, 0.013060389427006889, 0.015993867739790397, 0.016072838569560557, 0.01593922500052763, 0.01102143637804114, 0.02338589571564851, 0.004087254267694499, 0.0051756311428014104, 0.02422329280238587, 0.010455290207103516, 0.016770839500212797, 0.017960354704793555, 0.017576969638862086, 0.014317379221261731, 0.014114086406550786, 0.017396466837863254, 0.020710120566492872, 0.01642092102050076, 0.01097558416769616, 0.02478642442208831, 0.00548540558342727, 0.005323684098811656, 0.016227388959246684, 0.005443930964036098, 0.014733065329660804, 0.018743146330067177, 0.012909192654775628, 0.008739987434804022, 0.011674717966788378, 0.0184278933559313, 0.014981494020680232, 0.004121637640286353, 0.017838012653513945, 0.004970044914877922, 0.0030982481555503305, 0.01626376034332076, 0.006627473433755068, 0.015138462704988816, 0.014834797401634828, 0.009183651269098411, 0.009009550361997269, 0.01411359979662114, 0.01358496263246974, 0.006687216404920878, 0.01438930840746171, 0.0025889730270651653, 0.0017580358878388285, 0.021846883082955123, 0.01038055113602574, 0.012556113173333876, 0.01312190977995253, 0.012903889770480115, 0.01453162767339263, 0.015565344390170379, 0.011097848290572096, 0.02103428081716425, 0.0035707563530035266, 0.006469478238264653, 0.023961403616623873, 0.011510677745414285, 0.015020191965715399, 0.01822137353498716, 0.017122490837605944, 0.014059819348027892, 0.011043406542584289, 0.024829751223734736, 0.005635657724537035, 0.005240520379858544, 0.01984124915307361, 0.007421395503377377, 0.01482012438047514, 0.01985958951653199, 0.015074227673454708, 0.006101004943521389, 0.022769555478451962, 0.004501795613643143, 0.004238614036506371, 0.015520295584867904, 0.006263707572524283, 0.01699056932342509, 0.016686119951529785, 0.0051035195772570815, 0.013087489627609796, 0.003654491410257381, 0.001595854444707817, 0.01781113887641826, 0.007206792941651359, 0.016608923510643563, 0.00993304532345232, 0.017836979653137332, 0.0033018415023457186, 0.004747848661396952, 0.025194212887026175, 0.010814434987489284, 0.01067850444156564, 0.025176940762406414, 0.004436483697747514, 0.006240195245037421, 0.02352094226394629, 0.0021762622325544527, 0.023804503738032532, 0.0054135005952692565, 0.003899623954645857, 0.012069775354996705, 0.01125548840599496, 0.004342857122629055, 0.0011764515083034248, 0.02790184615830433, 0.001405400890533272, 0.007345134975041015, 0.007200376600114905, 0.0007868489902744847])
    cub_degree = 10
    tol = tol
    #190
    # edgeparams = T[-1.0, -0.8888888888888888, -0.7777777777777777, -0.6666666666666667, -0.5555555555555556, -0.4444444444444444, -0.3333333333333334, -0.22222222222222232, -0.11111111111111116, 0.0, 0.11111111111111116, 0.22222222222222232, 0.3333333333333334, 0.4444444444444444, 0.5555555555555556, 0.6666666666666667, 0.7777777777777777, 0.8888888888888888, 1.0]
    # cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    # AsymCubatures.setparams!(cub, edgeparams)
    # AsymCubatures.setweights!(cub, T[0.0007506793745026845, 0.0062899898225458346, 0.0015171812292002448, 0.0037936786398015147, 0.004426140120597826, 0.004081200604992408, 0.004177574889529475, 0.0020519887620438137, 0.004337036576543742, 0.004400425359070087, 0.004213742665490348, 0.002744209308269575, 0.003219160009895214, 0.005007101306708265, 0.0032648091416756712, 0.0044238702598676065, 0.001679207089794527, 0.005996079860366895, 0.0008582101737040578, 0.0063241862445902715, 0.02483524460295706, 0.01079654267812388, 0.02106785912744027, 0.01987610542151334, 0.017783066779062894, 0.014316125562573601, 0.015848948735660656, 0.02074563498171759, 0.020731615524751067, 0.01670411031115007, 0.013619494121199057, 0.017835360413998646, 0.021111453968868453, 0.02083315081954429, 0.00998347422946102, 0.025474853653973003, 0.006039213680597598, 0.0016030254421704334, 0.009944788993426023, 0.0024058613471707683, 0.00937529350750776, 0.009495219417252376, 0.005261833058131578, 0.006336666821014258, 0.008689532642825959, 0.008885447758369603, 0.008213761103324224, 0.004611781087029716, 0.006356031646781852, 0.00879343034689954, 0.009223083166654662, 0.002082360900678708, 0.010514631016865856, 0.00159857934861853, 0.0035015076529077323, 0.021535929613552465, 0.009669722123690546, 0.014614807148689712, 0.014434205909857705, 0.013882841524650833, 0.013620257609706388, 0.01413477921235245, 0.01309793042820771, 0.013792430135502656, 0.014808408109411347, 0.013931326068571169, 0.015048499068240717, 0.0097963079608191, 0.020477063926488556, 0.004184433161119335, 0.004991362777979943, 0.020540357950701346, 0.008603799491185187, 0.01432592807687423, 0.015115204193882011, 0.014034622358398278, 0.011695833038342651, 0.0127970794717149, 0.01383312273288346, 0.01494709714073073, 0.014137664287226669, 0.014450773637378348, 0.00986124810674854, 0.021005254059848443, 0.003821970945476313, 0.004234362351144119, 0.01684228109429759, 0.006237303077098259, 0.013088691704392927, 0.015709486815853938, 0.013457916067730866, 0.010637519437891487, 0.01015063764875087, 0.014026316247847125, 0.013972969429678943, 0.01239399092281044, 0.006967768185013725, 0.01576523954885164, 0.00478851981695169, 0.002290396030536791, 0.014762198077877993, 0.005758811827647902, 0.01333493125815999, 0.013261008130933019, 0.010330491224879997, 0.009564829525527384, 0.010167439385819396, 0.013420413149542156, 0.013221918873170185, 0.005370043894824067, 0.015028321458850483, 0.0032382273076751373, 0.0038759239864562924, 0.016935746079608405, 0.0073910089923171956, 0.015210821579523321, 0.012316159779376598, 0.010013149639574342, 0.010985539732886929, 0.012657422006295462, 0.014391791781510552, 0.008020447379934313, 0.01680844993245217, 0.003214079482880918, 0.004178176112090886, 0.020514148853706598, 0.008983076252672815, 0.013153184031344514, 0.012527620627986201, 0.013350256982694847, 0.012015939106920972, 0.013972904794779788, 0.009734084317271657, 0.020437490155912834, 0.0034690159428155524, 0.003989049747879382, 0.020084811194135698, 0.008773363816532577, 0.01343411331896536, 0.015284504154531333, 0.014876551026719803, 0.013677470631796586, 0.008492907144551707, 0.019476170605442156, 0.004637169393389022, 0.0038598271935995783, 0.015715652770612838, 0.005729660699386378, 0.013693693996843559, 0.015553510888322597, 0.013658066241925608, 0.005326720134114943, 0.016883541547203285, 0.004463078739376952, 0.0034648176734406494, 0.01530030931703708, 0.006102741926914262, 0.013500207697379875, 0.01393705499542685, 0.005733040435275046, 0.014071752983463508, 0.002634441097816497, 0.003169782346387581, 0.01749598274001116, 0.008690829819486323, 0.016049610126274143, 0.007985343754119781, 0.018303504224196455, 0.003144054739814429, 0.0042001917166097314, 0.02053267344653876, 0.008711161312705155, 0.010011655611855498, 0.020384276955289913, 0.004795061366709115, 0.0040171896045164725, 0.020455587202430243, 0.0033594843495351537, 0.021364401882816294, 0.0038712864588773674, 0.004610322157776943, 0.010555606111775794, 0.008892533187985448, 0.0036965869701124465, 0.0010955488477431296, 0.025630499778384042, 0.0023001945805674, 0.006243918990655082, 0.005811944401630793, 0.00084624631869679])
    # cub_degree = 10
    # tol = tol
    #210
    # edgeparams = T[-1.0, -0.8947368421052633, -0.7894736842105263, -0.6842105263157894, -0.5789473684210527, -0.4736842105263159, -0.368421052631579, -0.2631578947368421, -0.1578947368421053, -0.05263157894736853, 0.05263157894736853, 0.1578947368421053, 0.2631578947368421, 0.368421052631579, 0.4736842105263159, 0.5789473684210527, 0.6842105263157894, 0.7894736842105263, 0.8947368421052633, 1.0]
    # cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    # AsymCubatures.setparams!(cub, edgeparams)
    # AsymCubatures.setweights!(cub, T[0.0008216390723403258, 0.005162660323790845, 0.001661481923964486, 0.003908064244379281, 0.0035285886331748637, 0.00341439098870422, 0.0031930438659615616, 0.003154236819696575, 0.003386653647323407, 0.00356994548821489, 0.004004839080450116, 0.0027296175022262768, 0.003183971174314628, 0.0033061406757309035, 0.003793410362508103, 0.0033283004717525513, 0.0036730620153279654, 0.0018823951390724827, 0.005239994341823804, 0.0007993305253575401, 0.005490528719781894, 0.02271439524671804, 0.009716097020409454, 0.019489618669663016, 0.01519881026015013, 0.019377988515116507, 0.012968823046523711, 0.014709650521398207, 0.01659662468477516, 0.01774234026474462, 0.016078621950324497, 0.014206581139462613, 0.016251954405856205, 0.01593180820483474, 0.016061026242741503, 0.020510239798386405, 0.00820838127147422, 0.022840013116530385, 0.005395480076670841, 0.0012193632562716031, 0.008995105087130027, 0.001718799993854162, 0.0069522064908139935, 0.006786818535289648, 0.005883241134575472, 0.005514596490508218, 0.00518993658923109, 0.007775247975096133, 0.007598933299179542, 0.006871336537945756, 0.003074467030843649, 0.0061503081052488575, 0.006492104245431416, 0.008082832151388612, 0.0027547589097530302, 0.009176343504638734, 0.0014689814660303565, 0.003831973969941997, 0.020625841766930456, 0.008682612627765526, 0.016669006270053414, 0.01581950483557454, 0.01223971296841421, 0.012694270515521817, 0.013377661524407449, 0.013937265333973589, 0.014652739681829735, 0.0133230066586565, 0.013658555769701966, 0.013073267217005854, 0.01849757352107204, 0.006660244194073866, 0.020128745662888217, 0.003846133323518097, 0.003823924732398226, 0.015053261670975895, 0.006335395717283507, 0.013033261517978165, 0.009883189460457058, 0.010474214669456534, 0.009628903057518482, 0.012124193543446534, 0.009760891189908088, 0.010604832402672909, 0.00998089080394052, 0.00927432039490135, 0.012879614712220492, 0.006164407157332449, 0.015700850460950263, 0.0035249728644774613, 0.003807888356821634, 0.016719203085241597, 0.0068502178322684595, 0.011745291796936702, 0.01085337296531831, 0.017438694845929803, 0.009813795224351713, 0.010391311851963686, 0.01192497882175755, 0.010238392644956629, 0.016643558506209827, 0.013277898099761296, 0.004522553900479608, 0.01917949534208175, 0.003059312879075764, 0.0031888481658135276, 0.015050658699274225, 0.005799767799728809, 0.013328846866658873, 0.01054875535286259, 0.007973632621631789, 0.011192188743912273, 0.009692912624059424, 0.010849506365579305, 0.009830007865135968, 0.012824693672993331, 0.0059986957798152446, 0.013158770501436252, 0.004171012302570512, 0.002082015319019885, 0.01376609496167502, 0.006439412538123317, 0.013994810911170337, 0.009943870235575556, 0.011085065961872205, 0.009500114095955178, 0.010768066042690087, 0.010187674325299033, 0.014314031271039616, 0.005651053458152098, 0.014376112023858337, 0.002410091082451141, 0.004328646916831902, 0.016908502940521795, 0.005507208567192213, 0.01447492023906819, 0.01179972096866565, 0.011179764601516344, 0.010859705506428462, 0.009867810157324314, 0.013890951051968903, 0.006531411440351945, 0.01638141268313311, 0.003452179094194903, 0.0033759814560107735, 0.018708596023065027, 0.007994331687392584, 0.01408434604418287, 0.010359624294392375, 0.011908219462261843, 0.0102061306359201, 0.013478769657107679, 0.007827694449086566, 0.02023645691379093, 0.0034804236441730975, 0.004329246629871603, 0.015575782891446514, 0.0028649123355239843, 0.013918179257000613, 0.010536891124084475, 0.009963013413990337, 0.019943342349662583, 0.0013331629922500858, 0.015487425554029153, 0.0034274823197643954, 0.001773339271983852, 0.015757295572290414, 0.0061978233472606845, 0.015440620704320639, 0.009623212347729827, 0.013838440251827098, 0.00465998584529319, 0.014912133197790976, 0.0033001317190461334, 0.0036261814060146048, 0.014907288477345595, 0.0064588789407262915, 0.011448718416990385, 0.012395201982369642, 0.006217023357875218, 0.01580920827458119, 0.003449364726473969, 0.003087815035112301, 0.015931517726569654, 0.006452876717493011, 0.0173942595365016, 0.006116979123502705, 0.015852374640594448, 0.0029066443474912757, 0.004689222927960626, 0.015178065670513401, 0.008697957390535326, 0.007495638936257858, 0.016366175632895767, 0.0034001397369205284, 0.002621960342231991, 0.021049698036621108, 0.002616300352083172, 0.02118777519016449, 0.0037825198506407014, 0.0038960901830588715, 0.008324017549884622, 0.0076893499370438885, 0.0037586329639682577, 0.0017953832489512945, 0.023259645175868874, 0.0014987714997017393, 0.00520403294870215, 0.005425636402001298, 0.0007893775609408693])
    # cub_degree = 10
    # tol = tol
  else
    error("polynomial degree must be <= 10 (presently)\n")
  end

  mask = Int64[]
  append!(mask, (cub.numparams+1):(cub.numparams+cub.numweights))
  vtx = T[-1 -1; 1 -1; -1 1]
  CubatureB.solvecubature!(cub, cub_degree, mask, tol=tol)
  return cub, vtx
end


"""
### Cubature.getTetCubatureDiagE{T}

Returns a cubature rule and vertices for the SBP DiagE operators on tetrahedra;
these are cubatures that have nodes on the boundary that are analogous to LG or
LGL quadrature rules, which then leads to diagonal E.

**Inputs**

* `q`: maximum degree of polynomial for which the cubature is exact
* `T`: the data type used to represent the cubature
* `faceopertype`: the operator type on the facets of the tetrahedron
* `tol`: tolerance with which to solve the cubature

**Outputs**

* `cub`: a symmetric cubature for the right tetrahedron
* `vtx`: vertices for the right tetrahedron

"""
function getTetCubatureDiagE(q::Int, T=Float64; faceopertype::Symbol = :DiagE, tol=10*eps(typeof(real(one(T)))))
  cub_degree = q
  mask = zeros(Int64, (0))

  if q<=2 #20 nodes /4 numedgenodes
    edgeparams = T[-1.0, -0.3333333333333334, 0.3333333333333334, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.012435857349655468, 0.01523270066667647, 0.0021659093191483416, 0.018989382974950272, 0.03173325934136519, 0.2881132495136821, 0.013384875870991398, 0.007018866015954654, 0.01831029952392385, 0.02406037727569629, 0.0157264679429918, 0.27708953051466834, 0.02748106588500949, 0.23438249977167833, 0.24849639969648782, 0.0024897026330327433, 0.028537516913834892, 0.009725969009412595, 0.05607084763288441, 0.0018885554812893815])
    cub_degree = 2
    tol = tol
  elseif q<=3 #56 nodes /6 numedgenodes
    edgeparams = T[-1.0, -0.6000000000000001, -0.19999999999999996, 0.19999999999999996, 0.6000000000000001, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.0033860728837146773, 0.0010645239507503326, 0.004177563546833266, 0.005334780460182845, 0.028778374182650075, 0.002240148771270287, 0.009836851980799364, 0.08658853890918011, 0.011057574649362637, 0.0032277122263159276, 0.015711815309685084, 0.005690627672493255, 0.018213655533309826, 0.027210261032164028, 0.0028390899848656777, 0.011310281441745555, 0.008643464497236358, 0.0070689840737128105, 0.011300747575891331, 0.026848577271148765, 0.004551720710397526, 0.01678524282280978, 0.00906919825656638, 0.03097904960439749, 0.014556119861155428, 0.0011466086507357922, 0.01717563728469749, 0.02875061877031171, 0.17210946288567786, 0.040816350665297846, 0.01034007824268606, 0.1717830124287526, 0.011299684004873103, 0.011885197703101969, 0.010403048084887198, 0.006177963638335664, 0.010469008253422446, 0.09008795488112414, 0.001599468370282094, 0.006055044294973316, 0.020251643757264202, 0.12229758896186176, 0.030724055283156797, 0.0851307708183311, 0.019376821749281892, 0.005640440931615513, 0.007515532860066177, 0.003082896482684542, 0.022397660833371705, 0.007014836481611812, 0.009499233722063792, 0.005114143653447797, 0.0031758515524584058, 0.011474775692835823, 0.01268644784858113, 0.011380517336903049])
    cub_degree = 3
    tol = tol
  elseif q<=4 #165 nodes /9 numedgenodes
    edgeparams = T[-1.0, -0.75, -0.5, -0.25, 0.0, 0.25, 0.5, 0.75, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.0001052883456656782, 0.002182051833597663, 0.0015042118048487901, 0.0020019481932037377, 0.0011355436081461167, 0.0018927462022269499, 0.001460704435603025, 0.0021126326158059784, 4.638817880216871e-5, 0.0021443363451873576, 0.008767824337781144, 0.0070658537261371075, 0.0058339565298126655, 0.0060316653544000886, 0.00744781547062782, 0.00898082630998358, 0.0017850542077004498, 0.0016200602043774377, 0.007499236322883296, 0.004411173960046848, 0.003919368645138903, 0.00461575957348532, 0.007291600792600624, 0.002041790215596053, 0.0014241633584785257, 0.006484676576926784, 0.003585259687465165, 0.003401592467784409, 0.006521004856843718, 0.001849517588910346, 0.0014797703205622443, 0.00675136633797547, 0.004049941898236682, 0.006158837132447182, 0.0013655064551021077, 0.0017610948172916937, 0.007101576534156777, 0.007710018022261281, 0.0017850957953698292, 0.00187923662849184, 0.007841394792380718, 0.0016720021833722667, 0.002410832876579115, 0.0017945027164956477, 8.716710309346596e-5, 0.0020559267136382397, 0.00854008122144723, 0.0070658587470202325, 0.006837442416529006, 0.006640006247704058, 0.007248727602785201, 0.008617999716652237, 0.0023867271854444046, 0.008598608767547587, 0.03125368615684083, 0.023061182068603376, 0.021447941767622273, 0.02298864287631468, 0.030322076200935487, 0.008759995301544032, 0.006984945958110747, 0.022832836668982382, 0.015757860094884373, 0.015372805657455177, 0.023333790094955825, 0.006455579761594713, 0.006240853906074215, 0.02097442868497247, 0.016234628160270125, 0.021079360035197784, 0.0059055063121604846, 0.006256812622746669, 0.023366494760611027, 0.023726913782760317, 0.005708711981176118, 0.006463830287309096, 0.030970253183628997, 0.007446928135197949, 0.008782922401322031, 0.009532101880965843, 0.0020889826613973293, 0.002058203674252743, 0.006038316969304857, 0.004436871352640496, 0.0039005395024332484, 0.0036235381540044498, 0.006704279163968761, 0.0018559650731976218, 0.006955297982526064, 0.023390921165259468, 0.016401435617420856, 0.0160973801694649, 0.023595692058630786, 0.006769253713111384, 0.00480254536195333, 0.016675967867286656, 0.012666489807011853, 0.01674252978064571, 0.004382329724982831, 0.0041102451090173475, 0.016265469554313343, 0.01595201651845194, 0.004107082250267515, 0.004443796224315192, 0.02241637407746083, 0.004530096847874534, 0.00675183936487861, 0.006958237253124048, 0.0015242509426657972, 0.0018315062589856275, 0.0064814253178540945, 0.004434764457299402, 0.004287643708541693, 0.006002643177949044, 0.0018950926055327205, 0.005762049481669368, 0.020938940568173695, 0.01569805149333554, 0.021066714300947774, 0.006608896791542186, 0.0034044242106306874, 0.0162887530981348, 0.016052621555581657, 0.0041781100655661025, 0.00415832397476526, 0.0215923791800737, 0.00409509121028138, 0.006036509975161872, 0.005693300203309176, 0.0018846425196036676, 0.0018170400106610155, 0.005705094226111926, 0.0038141145772700898, 0.006951012008230701, 0.001603563282641295, 0.00645007637667043, 0.022972743558056716, 0.022931325482697613, 0.006582842661582884, 0.0044766414078009865, 0.022674216199666967, 0.004874328358263963, 0.007115184902999555, 0.005377415899035011, 0.0016649319535200736, 0.0017728121986516374, 0.007360651712741081, 0.007090133428530268, 0.0005691013655695147, 0.0071790651951695985, 0.030298441795251534, 0.006930435857551298, 0.0069336528499146744, 0.006792479019209073, 0.0018836201918372706, 0.0013609567743144621, 0.009521441614177195, 0.00212147377386212, 0.008526465069859001, 0.009337821515768209, 0.0018466335619085673, 0.002071753609961075, 0.0017960597439375153, 0.0018387720368300252, 0.00018833629138898645])
    cub_degree = 4
    tol = tol
  elseif q<=5 #220 nodes /10 numedgenodes
    edgeparams = T[-1.0, -0.7777777777777777, -0.5555555555555556, -0.3333333333333334, -0.11111111111111116, 0.11111111111111116, 0.3333333333333334, 0.5555555555555556, 0.7777777777777777, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.0005520860714598192, 0.0019002289527573384, 0.0007366881077259075, 0.0010148309021348306, 0.0010560864578816635, 0.0012641140882711413, 0.0013000823817240783, 0.0009176149405911522, 0.0015955311337600498, 0.0006375968482459475, 0.002052760859538399, 0.0055422566713123995, 0.0039527442336531856, 0.005018254951424061, 0.005070247097720801, 0.004713432140568569, 0.0038675390371970355, 0.005398531889857046, 0.0018743548110777273, 0.0005711030540820571, 0.0035711574601174742, 0.002622842090072228, 0.002940501045160954, 0.0033595696026427566, 0.002303221644351997, 0.0041574360728833795, 0.0007502856146164168, 0.0009789694145303626, 0.004815987034169158, 0.0028528150861800218, 0.002855601396455508, 0.00275266102325168, 0.004633433390593587, 0.0009462130523197049, 0.0013353998177133254, 0.0056246173634750575, 0.002821354109468073, 0.0026731137637381304, 0.005236299855872349, 0.0013016998675099008, 0.0012586477652459715, 0.004873124510532451, 0.002467875634773874, 0.005014105191884624, 0.0016279968717643097, 0.0011222623121772992, 0.003982219118637023, 0.003534774127965951, 0.0011681608724322921, 0.00046776763720144185, 0.005991395254786586, 0.00013718529877011228, 0.0018743874151303523, 0.0019055096065594183, 0.0005632268960038933, 0.0017433796119006282, 0.005425099150078425, 0.003513945632525923, 0.005435490627716671, 0.005245934867088027, 0.0048924370114158365, 0.00400545157008522, 0.005527031943978761, 0.0017859640322814652, 0.005296029923111166, 0.023233907794920516, 0.017687832325472663, 0.02007933146576438, 0.01922687018788484, 0.017159491722531874, 0.02296862758989303, 0.005505823540499972, 0.0038622514994390397, 0.01765560435519825, 0.010951456106151614, 0.010563426069584672, 0.011438220350230132, 0.01761561112700965, 0.0038376914583453103, 0.005049417708554092, 0.019780635555434804, 0.010721678809891458, 0.013162685315222973, 0.02006539870909473, 0.004919056038606344, 0.005507714334139566, 0.0195422721094823, 0.010823281427756702, 0.019973424013768087, 0.005111575839410089, 0.005010752899560892, 0.01652757719756994, 0.0174206646182386, 0.0049337031051620685, 0.003909847203911802, 0.023086932051730936, 0.00443105798017081, 0.005746393355485979, 0.0060120558966050616, 0.0016384335047239925, 0.0007299644089700022, 0.0035529001324296986, 0.0027149036587421163, 0.003256762527030351, 0.0025629044987347414, 0.00237400872076105, 0.003837041905382006, 0.0005423170519110516, 0.0039320508156448705, 0.017657710963234444, 0.01083041278138577, 0.010437371806735396, 0.01062020246595161, 0.017621354916100326, 0.00477029687922771, 0.002511008831126291, 0.010634256074760486, 0.003285667438104494, 0.004938150985838547, 0.011379167502624327, 0.001815812247664094, 0.0030416844597271273, 0.010854256275341305, 0.004684138849976064, 0.009173892395043043, 0.0016506775468137014, 0.0027115544011681652, 0.01170416431612294, 0.0113025366201047, 0.0021860208908688044, 0.0022033102432519585, 0.017435477108400977, 0.0019319807281487195, 0.003503570412159344, 0.0034154948386463414, 0.0005464505010378956, 0.001554478707808704, 0.00496506015037204, 0.00306708955585662, 0.0028318414435494813, 0.002353512670968809, 0.005408137281708584, 0.0009980042246965906, 0.00508352505268231, 0.0194425361580747, 0.010846474915793375, 0.013419063815034236, 0.019806955756433195, 0.004872776367963738, 0.0026907167388338185, 0.010944158030952238, 0.005094551179671759, 0.008884385985924918, 0.0022037567749968153, 0.002884503935269034, 0.013291165704008213, 0.009046028875846185, 0.009406015380807108, 0.002659575682898315, 0.019971043797130227, 0.0020557766646712218, 0.005448707974018047, 0.0050690375871762505, 0.0016619433576434406, 0.0010039560366007945, 0.005207460039061509, 0.002926730667253722, 0.0027118698774204635, 0.005247457475635381, 0.0013366021962090242, 0.005271322204137178, 0.019131300879538994, 0.011329195407454086, 0.020343164524712087, 0.004808753735069847, 0.002551274753787951, 0.010765569222096903, 0.011001866144947092, 0.001950910305133125, 0.002908272634336513, 0.02009940619090141, 0.0020665366164474216, 0.0050774954355292555, 0.004967503757298188, 0.0010601597141297013, 0.000844859036864622, 0.005346097211426216, 0.002294312170490547, 0.004902848631487478, 0.0012768829847641325, 0.005856639370257183, 0.017070457301238254, 0.01752557290398545, 0.0047827409076904625, 0.0024032193199958036, 0.017788287921185912, 0.0022105261171326963, 0.004885456411705522, 0.004875037091145212, 0.0012463465546663406, 0.00098650716312951, 0.00403418402109373, 0.0037949898084725523, 0.0011163233329602987, 0.0037253867754721884, 0.02276606188296336, 0.004073331334367647, 0.003638763915871856, 0.004055563541448107, 0.0008295888195269148, 0.0009612363707887323, 0.005266640511621673, 0.0008837730355693601, 0.005499066661479238, 0.005715513586804544, 0.0013709690696029123, 0.001846977156402859, 0.0017287346460900736, 0.0014124793455059586, 0.000651481144865028])
    cub_degree = 5
    tol = tol
  elseif q<=6 #455 nodes /13 numedgenodes
    edgeparams = T[-1.0, -0.8333333333333333, -0.6666666666666667, -0.5, -0.3333333333333334, -0.16666666666666674, 0.0, 0.16666666666666674, 0.3333333333333334, 0.5, 0.6666666666666667, 0.8333333333333333, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[5.616557606877841e-5, 0.0006038992031887577, 0.000379255038372771, 0.0005142578824115499, 0.0004417277443836679, 0.00047179079338070427, 0.0004840668613069628, 0.00046327350943022825, 0.00042572374371460653, 0.0004948467960174047, 0.0003670479709630796, 0.0006131226355179123, 6.976407479213569e-5, 0.0006038992031887575, 0.0028611639359276127, 0.0015926383418914647, 0.002094597926420249, 0.0019149404053357569, 0.002099481802814672, 0.002109278982692659, 0.0019375987727916996, 0.002113399998863202, 0.001595231088292381, 0.002851986965946042, 0.0006036643567004762, 0.0003792550383727698, 0.0015926383418914639, 0.0006861855641784806, 0.0010234439033582202, 0.001073200203237962, 0.0012281724547717958, 0.0011101596054066127, 0.0010767250597392276, 0.000720317322253373, 0.0015777430180127154, 0.00035829077326883025, 0.0005142578824115498, 0.0020945979264202484, 0.0010234439033582191, 0.0016687804385707135, 0.0016367226147032394, 0.0016484617147907144, 0.001697597843108259, 0.0010502609471187768, 0.002088402837309738, 0.0004946843509201242, 0.0004417277443836671, 0.0019149404053357558, 0.0010732002032379621, 0.0016367226147032392, 0.0015023134696835817, 0.0016277383392010205, 0.0010654576372997552, 0.001910520473665041, 0.0004353123457688811, 0.00047179079338070524, 0.002099481802814673, 0.0012281724547717936, 0.0016484617147907174, 0.001627738339201021, 0.0011893700444490392, 0.0020874271009247887, 0.00047892752883563943, 0.0004840668613069615, 0.002109278982692655, 0.001110159605406614, 0.0016975978431082606, 0.0010654576372997532, 0.00208742710092479, 0.0004990638527349488, 0.0004632735094302295, 0.0019375987727916994, 0.001076725059739228, 0.0010502609471187768, 0.001910520473665041, 0.00047892752883563964, 0.00042572374371460653, 0.0021133999988632033, 0.0007203173222533704, 0.002088402837309738, 0.0004353123457688812, 0.000494846796017405, 0.0015952310882923792, 0.0015777430180127152, 0.0004946843509201248, 0.00036704797096307997, 0.0028519869659460423, 0.0003582907732688306, 0.0006131226355179125, 0.0006036643567004765, 6.97640747921354e-5, 0.0006038992031887581, 0.0028611639359276114, 0.0015926383418914632, 0.002094597926420249, 0.0019149404053357573, 0.0020994818028146705, 0.002109278982692656, 0.0019375987727916994, 0.0021133999988632033, 0.0015952310882923798, 0.0028519869659460414, 0.0006036643567004753, 0.0028611639359276122, 0.011699598193102905, 0.006389725640996263, 0.008842686554349269, 0.008482645078112803, 0.008978141463232085, 0.00847433617474051, 0.008826508830176268, 0.00636424090071221, 0.011671242292523339, 0.0028526178253211495, 0.0015926383418914628, 0.006389725640996259, 0.003180371512674028, 0.005018518010580365, 0.0051033261973058245, 0.005067660574074285, 0.0049468232129215774, 0.003141822698610169, 0.00641717615266952, 0.00160358987999176, 0.0020945979264202492, 0.008842686554349262, 0.005018518010580365, 0.007543276910462022, 0.006945126688297583, 0.007478533640971024, 0.0049799428668512655, 0.008905365758126288, 0.002123726954541348, 0.0019149404053357562, 0.008482645078112803, 0.005103326197305823, 0.006945126688297585, 0.006196537174699665, 0.005081737045074244, 0.008551841538704703, 0.0019458129957122643, 0.0020994818028146726, 0.008978141463232085, 0.005067660574074289, 0.007478533640971029, 0.005081737045074245, 0.00904059409469173, 0.0021193380144190824, 0.002109278982692658, 0.00847433617474051, 0.004946823212921577, 0.004979942866851267, 0.008551841538704707, 0.002119338014419083, 0.0019375987727917, 0.008826508830176261, 0.003141822698610168, 0.008905365758126282, 0.001945812995712266, 0.002113399998863202, 0.0063642409007121994, 0.006417176152669513, 0.0021237269545413494, 0.0015952310882923805, 0.011671242292523334, 0.0016035898799917619, 0.0028519869659460423, 0.0028526178253211543, 0.0006036643567004772, 0.0003792550383727693, 0.0015926383418914637, 0.0006861855641784812, 0.0010234439033582209, 0.0010732002032379639, 0.0012281724547717956, 0.0011101596054066134, 0.0010767250597392272, 0.0007203173222533724, 0.0015777430180127156, 0.0003582907732688301, 0.0015926383418914628, 0.006389725640996261, 0.003180371512674029, 0.005018518010580367, 0.005103326197305824, 0.005067660574074287, 0.004946823212921581, 0.0031418226986101717, 0.006417176152669517, 0.0016035898799917605, 0.0006861855641784791, 0.003180371512674025, 0.0014968888558893486, 0.002718968826471398, 0.0026126413722363543, 0.0026037386014986174, 0.001410745181336525, 0.0032484832077164234, 0.0007296434117107208, 0.0010234439033582204, 0.005018518010580364, 0.0027189688264713987, 0.003897836418282347, 0.003405111248674317, 0.002701739567059856, 0.005063234596981209, 0.0010275002583028088, 0.0010732002032379623, 0.005103326197305824, 0.0026126413722363556, 0.00340511124867432, 0.0034387041987257883, 0.005133748115506978, 0.0010060964405929854, 0.0012281724547717966, 0.00506766057407429, 0.00260373860149862, 0.002701739567059856, 0.005133748115506977, 0.0011139902688666618, 0.0011101596054066138, 0.004946823212921579, 0.0014107451813365202, 0.005063234596981209, 0.001006096440592985, 0.0010767250597392268, 0.0031418226986101657, 0.003248483207716418, 0.00102750025830281, 0.0007203173222533725, 0.006417176152669517, 0.0007296434117107225, 0.001577743018012717, 0.0016035898799917623, 0.00035829077326883106, 0.0005142578824115501, 0.00209459792642025, 0.0010234439033582204, 0.0016687804385707146, 0.001636722614703239, 0.0016484617147907172, 0.0016975978431082617, 0.001050260947118777, 0.0020884028373097403, 0.0004946843509201247, 0.002094597926420251, 0.008842686554349263, 0.005018518010580366, 0.007543276910462026, 0.0069451266882975815, 0.007478533640971025, 0.004979942866851266, 0.008905365758126284, 0.0021237269545413503, 0.0010234439033582202, 0.005018518010580366, 0.0027189688264714, 0.003897836418282348, 0.003405111248674317, 0.0027017395670598555, 0.0050632345969812125, 0.001027500258302808, 0.001668780438570716, 0.007543276910462028, 0.0038978364182823493, 0.005496910408755051, 0.005185471251780517, 0.0075240188231792795, 0.001555823909459198, 0.0016367226147032397, 0.006945126688297585, 0.003405111248674319, 0.0051854712517805145, 0.005226151200337717, 0.0014178684373856757, 0.0016484617147907187, 0.007478533640971028, 0.002701739567059853, 0.00752401882317928, 0.0014178684373856755, 0.0016975978431082624, 0.0049799428668512655, 0.00506323459698121, 0.0015558239094591987, 0.0010502609471187776, 0.00890536575812628, 0.00102750025830281, 0.0020884028373097403, 0.00212372695454135, 0.0004946843509201252, 0.0004417277443836673, 0.001914940405335757, 0.0010732002032379615, 0.0016367226147032384, 0.0015023134696835812, 0.0016277383392010194, 0.0010654576372997535, 0.0019105204736650423, 0.0004353123457688814, 0.0019149404053357573, 0.008482645078112801, 0.005103326197305823, 0.0069451266882975884, 0.0061965371746996655, 0.005081737045074244, 0.008551841538704705, 0.001945812995712265, 0.001073200203237962, 0.0051033261973058245, 0.002612641372236356, 0.003405111248674319, 0.003438704198725788, 0.005133748115506977, 0.001006096440592984, 0.0016367226147032397, 0.006945126688297584, 0.0034051112486743174, 0.005185471251780515, 0.005226151200337715, 0.001417868437385674, 0.0015023134696835806, 0.006196537174699666, 0.0034387041987257853, 0.005226151200337715, 0.00412123259677625, 0.0016277383392010213, 0.005081737045074242, 0.005133748115506977, 0.0014178684373856757, 0.0010654576372997548, 0.008551841538704707, 0.0010060964405929848, 0.0019105204736650434, 0.0019458129957122667, 0.0004353123457688816, 0.00047179079338070535, 0.0020994818028146713, 0.0012281724547717947, 0.0016484617147907172, 0.00162773833920102, 0.0011893700444490399, 0.0020874271009247904, 0.00047892752883563954, 0.002099481802814673, 0.008978141463232087, 0.005067660574074288, 0.007478533640971028, 0.005081737045074242, 0.009040594094691733, 0.002119338014419083, 0.0012281724547717956, 0.00506766057407429, 0.002603738601498618, 0.002701739567059854, 0.005133748115506977, 0.0011139902688666612, 0.0016484617147907177, 0.007478533640971028, 0.0027017395670598525, 0.007524018823179274, 0.001417868437385674, 0.001627738339201021, 0.005081737045074241, 0.005133748115506974, 0.001417868437385675, 0.0011893700444490407, 0.009040594094691724, 0.0011139902688666631, 0.002087427100924791, 0.0021193380144190837, 0.0004789275288356405, 0.00048406686130696164, 0.0021092789826926564, 0.001110159605406614, 0.001697597843108263, 0.001065457637299754, 0.0020874271009247904, 0.0004990638527349485, 0.0021092789826926556, 0.008474336174740506, 0.00494682321292158, 0.004979942866851266, 0.008551841538704709, 0.0021193380144190837, 0.0011101596054066136, 0.004946823212921577, 0.0014107451813365206, 0.005063234596981208, 0.0010060964405929852, 0.0016975978431082621, 0.004979942866851261, 0.00506323459698121, 0.001555823909459199, 0.001065457637299755, 0.008551841538704705, 0.0010060964405929843, 0.002087427100924792, 0.002119338014419084, 0.0004990638527349488, 0.0004632735094302306, 0.0019375987727917015, 0.0010767250597392285, 0.0010502609471187772, 0.0019105204736650416, 0.0004789275288356399, 0.0019375987727917013, 0.008826508830176268, 0.0031418226986101687, 0.00890536575812628, 0.0019458129957122653, 0.0010767250597392285, 0.0031418226986101665, 0.0032484832077164173, 0.0010275002583028108, 0.0010502609471187774, 0.008905365758126286, 0.0010275002583028095, 0.0019105204736650427, 0.0019458129957122656, 0.0004789275288356398, 0.0004257237437146066, 0.0021133999988632037, 0.0007203173222533729, 0.00208840283730974, 0.0004353123457688816, 0.002113399998863204, 0.006364240900712202, 0.006417176152669516, 0.002123726954541351, 0.0007203173222533725, 0.006417176152669516, 0.0007296434117107226, 0.002088402837309738, 0.00212372695454135, 0.00043531234576888123, 0.0004948467960174054, 0.0015952310882923813, 0.0015777430180127167, 0.0004946843509201255, 0.0015952310882923816, 0.011671242292523337, 0.0016035898799917634, 0.0015777430180127171, 0.0016035898799917632, 0.000494684350920125, 0.0003670479709630808, 0.002851986965946044, 0.0003582907732688313, 0.0028519869659460436, 0.002852617825321154, 0.00035829077326883117, 0.0006131226355179133, 0.0006036643567004775, 0.0006036643567004775, 6.976407479213585e-5])
    cub_degree = 6
    tol = tol
  elseif q<=7 #560 nodes /14 numedgenodes
    edgeparams = T[-1.0, -0.8461538461538463, -0.6923076923076923, -0.5384615384615383, -0.3846153846153846, -0.23076923076923078, -0.07692307692307687, 0.07692307692307687, 0.23076923076923078, 0.3846153846153846, 0.5384615384615383, 0.6923076923076923, 0.8461538461538463, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.00022214716789600232, 0.0005118067903035457, 0.00022718498316676972, 0.00041342401697276636, 0.000392446674821418, 0.00036758706456050034, 0.0003250586791796236, 0.00032392270677371364, 0.0003654579880547455, 0.0003922776739875796, 0.0004174234014612876, 0.0002335909693004213, 0.0005131087925300029, 0.00021829161858727457, 0.000511806790303546, 0.0019131399910531307, 0.0011464788677429606, 0.0018135782375657313, 0.0016213499232313696, 0.0015625446757288601, 0.0015116163063173117, 0.0015593853605237976, 0.0016160410401228555, 0.0018087194362611638, 0.0011449744341210217, 0.001915212193811265, 0.0005119066782702678, 0.00022718498316676936, 0.0011464788677429567, 0.0006074673948127234, 0.0008514173110468231, 0.00073668501906857, 0.0007853402863433803, 0.0007877150237544732, 0.0007401675879389983, 0.0008491298689521512, 0.0005987931489346206, 0.0011436708638168883, 0.00023230222123383926, 0.0004134240169727671, 0.001813578237565728, 0.0008514173110468223, 0.0012163552165011463, 0.0011929831370404613, 0.0013191905594573984, 0.0012006094281631246, 0.001221744092485294, 0.0008470766990691255, 0.0018080818421458548, 0.0004173452552431768, 0.00039244667482141973, 0.0016213499232313677, 0.0007366850190685723, 0.0011929831370404637, 0.0012702631706853667, 0.001273959855469231, 0.0011991093916492222, 0.0007366901749402871, 0.001616517249399077, 0.0003936360815511714, 0.0003675870645604988, 0.0015625446757288588, 0.0007853402863433827, 0.0013191905594574001, 0.0012739598554692296, 0.0013206104215226892, 0.0007853129439464144, 0.001560306283851838, 0.0003674249773872635, 0.00032505867917962436, 0.0015116163063173137, 0.0007877150237544778, 0.0012006094281631252, 0.0011991093916492238, 0.0007853129439464142, 0.001511637569666244, 0.0003253348632443211, 0.0003239227067737148, 0.0015593853605237965, 0.0007401675879389926, 0.0012217440924852945, 0.0007366901749402856, 0.0015603062838518366, 0.0003253348632443205, 0.0003654579880547452, 0.001616041040122853, 0.0008491298689521515, 0.0008470766990691235, 0.0016165172493990735, 0.00036742497738726215, 0.00039227767398757903, 0.0018087194362611627, 0.0005987931489346242, 0.0018080818421458598, 0.00039363608155117114, 0.00041742340146128885, 0.0011449744341210206, 0.0011436708638168883, 0.00041734525524317746, 0.00023359096930042198, 0.0019152121938112643, 0.00023230222123384018, 0.0005131087925300025, 0.0005119066782702678, 0.0002182916185872749, 0.0005118067903035453, 0.0019131399910531316, 0.0011464788677429574, 0.0018135782375657274, 0.0016213499232313672, 0.001562544675728858, 0.0015116163063173132, 0.0015593853605237963, 0.0016160410401228511, 0.0018087194362611642, 0.0011449744341210197, 0.001915212193811264, 0.0005119066782702672, 0.0019131399910531342, 0.008927340558793918, 0.005660688168497699, 0.007628428161037405, 0.006769520709884788, 0.006935437033167803, 0.006941655997720352, 0.006779968417696969, 0.0076282247540624985, 0.005647325444573116, 0.00892110304805323, 0.0019191327390805108, 0.0011464788677429559, 0.0056606881684976955, 0.002806162218022262, 0.0036045639286569507, 0.003641191291638127, 0.004087579686526469, 0.0036624777754998535, 0.0036272093185281268, 0.0028128315080632794, 0.005655106363034933, 0.0011469607705917309, 0.0018135782375657279, 0.007628428161037398, 0.00360456392865695, 0.005567849241614734, 0.005892025243847476, 0.005897973451571414, 0.005583936516792391, 0.0036235190442418, 0.007635624067499211, 0.0018067141510278888, 0.0016213499232313655, 0.006769520709884782, 0.003641191291638129, 0.0058920252438474825, 0.005945686331755556, 0.005886991516693599, 0.0036511341291598077, 0.006786935708511304, 0.0016118976714697328, 0.0015625446757288588, 0.006935437033167803, 0.004087579686526475, 0.005897973451571415, 0.005886991516693602, 0.004081219606028041, 0.006953739474674249, 0.0015548546030578596, 0.0015116163063173158, 0.006941655997720349, 0.003662477775499852, 0.005583936516792387, 0.0036511341291598025, 0.006953739474674243, 0.001506085945376339, 0.0015593853605237978, 0.0067799684176969716, 0.0036272093185281194, 0.003623519044241797, 0.006786935708511296, 0.0015548546030578596, 0.0016160410401228546, 0.007628224754062498, 0.0028128315080632755, 0.007635624067499214, 0.0016118976714697328, 0.0018087194362611636, 0.005647325444573106, 0.00565510636303494, 0.0018067141510278888, 0.001144974434121021, 0.008921103048053224, 0.0011469607705917343, 0.0019152121938112651, 0.0019191327390805108, 0.000511906678270267, 0.00022718498316676877, 0.0011464788677429567, 0.0006074673948127254, 0.0008514173110468238, 0.0007366850190685714, 0.0007853402863433818, 0.0007877150237544754, 0.0007401675879389975, 0.0008491298689521518, 0.0005987931489346225, 0.0011436708638168883, 0.0002323022212338396, 0.001146478867742957, 0.005660688168497696, 0.002806162218022263, 0.003604563928656952, 0.0036411912916381284, 0.004087579686526475, 0.0036624777754998513, 0.003627209318528124, 0.0028128315080632824, 0.0056551063630349355, 0.0011469607705917322, 0.0006074673948127251, 0.002806162218022263, 0.00010288830134136413, 0.0010345070760491835, 0.0019013000705857908, 0.0018940620735580119, 0.0010244765933582498, 0.00010904500908360608, 0.0028163867062949367, 0.0005966927775465257, 0.0008514173110468239, 0.003604563928656949, 0.0010345070760491837, 0.002968955571945273, 0.00336155764717954, 0.0029171521035902576, 0.001002923870342785, 0.0036260573580841316, 0.0008425275672697687, 0.0007366850190685707, 0.0036411912916381292, 0.0019013000705857958, 0.003361557647179544, 0.00298660330715531, 0.0018391550404176567, 0.0036608067420005924, 0.0007355932433954174, 0.0007853402863433831, 0.004087579686526472, 0.001894062073558009, 0.0029171521035902567, 0.0018391550404176524, 0.004095021134462823, 0.0007887652095684698, 0.0007877150237544745, 0.0036624777754998496, 0.00102447659335825, 0.001002923870342781, 0.003660806742000591, 0.0007887652095684677, 0.0007401675879389969, 0.003627209318528122, 0.00010904500908360196, 0.0036260573580841316, 0.0007355932433954172, 0.0008491298689521531, 0.00281283150806328, 0.002816386706294936, 0.000842527567269769, 0.0005987931489346245, 0.005655106363034938, 0.0005966927775465283, 0.0011436708638168892, 0.0011469607705917309, 0.00023230222123383918, 0.00041342401697276745, 0.0018135782375657274, 0.0008514173110468266, 0.0012163552165011487, 0.0011929831370404618, 0.0013191905594573982, 0.0012006094281631241, 0.0012217440924852968, 0.0008470766990691255, 0.001808081842145856, 0.00041734525524317665, 0.0018135782375657298, 0.007628428161037399, 0.0036045639286569507, 0.005567849241614739, 0.005892025243847477, 0.0058979734515714165, 0.005583936516792393, 0.003623519044241804, 0.007635624067499217, 0.001806714151027888, 0.0008514173110468241, 0.003604563928656949, 0.001034507076049183, 0.002968955571945273, 0.0033615576471795403, 0.0029171521035902563, 0.001002923870342781, 0.00362605735808413, 0.0008425275672697685, 0.0012163552165011483, 0.0055678492416147375, 0.002968955571945274, 0.005085091023649168, 0.004492634263091147, 0.002881444422292749, 0.005586652676769597, 0.0012218448711425176, 0.001192983137040463, 0.0058920252438474825, 0.003361557647179545, 0.00449263426309115, 0.004117847187174561, 0.005900914051254877, 0.0012125117170141274, 0.0013191905594573986, 0.005897973451571417, 0.0029171521035902584, 0.0028814444222927484, 0.005900914051254877, 0.0013402439370390337, 0.001200609428163125, 0.005583936516792393, 0.0010029238703427833, 0.005586652676769599, 0.0012125117170141266, 0.0012217440924852942, 0.0036235190442418016, 0.003626057358084132, 0.0012218448711425179, 0.0008470766990691259, 0.007635624067499215, 0.0008425275672697693, 0.0018080818421458583, 0.0018067141510278882, 0.0004173452552431768, 0.00039244667482141984, 0.0016213499232313688, 0.0007366850190685712, 0.0011929831370404626, 0.0012702631706853688, 0.0012739598554692296, 0.0011991093916492242, 0.0007366901749402881, 0.001616517249399076, 0.00039363608155117163, 0.001621349923231367, 0.006769520709884785, 0.003641191291638129, 0.005892025243847482, 0.005945686331755554, 0.005886991516693601, 0.0036511341291598064, 0.0067869357085113, 0.0016118976714697337, 0.0007366850190685702, 0.0036411912916381258, 0.0019013000705857934, 0.003361557647179541, 0.002986603307155309, 0.0018391550404176535, 0.0036608067420005924, 0.0007355932433954176, 0.001192983137040462, 0.005892025243847478, 0.0033615576471795407, 0.004492634263091147, 0.004117847187174561, 0.005900914051254877, 0.0012125117170141274, 0.0012702631706853684, 0.005945686331755555, 0.002986603307155311, 0.004117847187174563, 0.004763944496186141, 0.0013028824616940506, 0.0012739598554692305, 0.0058869915166936005, 0.0018391550404176552, 0.005900914051254878, 0.0013028824616940528, 0.0011991093916492255, 0.003651134129159805, 0.003660806742000595, 0.001212511717014127, 0.0007366901749402872, 0.0067869357085112965, 0.0007355932433954186, 0.0016165172493990757, 0.0016118976714697359, 0.00039363608155117147, 0.00036758706456049855, 0.0015625446757288588, 0.000785340286343382, 0.0013191905594573986, 0.0012739598554692302, 0.0013206104215226877, 0.0007853129439464141, 0.0015603062838518362, 0.00036742497738726393, 0.0015625446757288584, 0.006935437033167801, 0.0040875796865264755, 0.005897973451571417, 0.005886991516693598, 0.0040812196060280425, 0.00695373947467425, 0.0015548546030578591, 0.0007853402863433818, 0.004087579686526472, 0.00189406207355801, 0.0029171521035902537, 0.001839155040417652, 0.004095021134462824, 0.0007887652095684695, 0.001319190559457398, 0.005897973451571415, 0.002917152103590256, 0.0028814444222927476, 0.005900914051254875, 0.001340243937039033, 0.0012739598554692329, 0.005886991516693599, 0.0018391550404176546, 0.0059009140512548755, 0.0013028824616940493, 0.0013206104215226892, 0.0040812196060280425, 0.004095021134462822, 0.0013402439370390343, 0.0007853129439464148, 0.0069537394746742465, 0.0007887652095684708, 0.0015603062838518379, 0.0015548546030578602, 0.00036742497738726415, 0.0003250586791796242, 0.0015116163063173152, 0.0007877150237544753, 0.0012006094281631241, 0.0011991093916492238, 0.0007853129439464142, 0.0015116375696662475, 0.0003253348632443213, 0.0015116163063173139, 0.0069416559977203566, 0.003662477775499854, 0.005583936516792394, 0.003651134129159806, 0.006953739474674248, 0.001506085945376337, 0.0007877150237544744, 0.003662477775499852, 0.0010244765933582502, 0.0010029238703427818, 0.0036608067420005916, 0.0007887652095684696, 0.0012006094281631235, 0.005583936516792392, 0.001002923870342781, 0.005586652676769596, 0.0012125117170141257, 0.0011991093916492246, 0.0036511341291598047, 0.0036608067420005903, 0.0012125117170141263, 0.0007853129439464151, 0.006953739474674244, 0.0007887652095684691, 0.0015116375696662488, 0.0015060859453763392, 0.0003253348632443211, 0.00032392270677371576, 0.001559385360523798, 0.000740167587938998, 0.0012217440924852947, 0.0007366901749402874, 0.0015603062838518383, 0.0003253348632443208, 0.0015593853605237983, 0.0067799684176969716, 0.0036272093185281246, 0.0036235190442418033, 0.006786935708511299, 0.00155485460305786, 0.000740167587938997, 0.003627209318528122, 0.00010904500908360343, 0.0036260573580841307, 0.0007355932433954175, 0.0012217440924852958, 0.0036235190442418, 0.0036260573580841316, 0.0012218448711425185, 0.0007366901749402878, 0.006786935708511296, 0.0007355932433954176, 0.0015603062838518368, 0.0015548546030578602, 0.0003253348632443209, 0.0003654579880547451, 0.0016160410401228537, 0.0008491298689521528, 0.0008470766990691258, 0.0016165172493990748, 0.00036742497738726296, 0.001616041040122856, 0.007628224754062497, 0.0028128315080632764, 0.007635624067499213, 0.001611897671469734, 0.0008491298689521529, 0.0028128315080632725, 0.0028163867062949376, 0.000842527567269769, 0.0008470766990691246, 0.007635624067499217, 0.0008425275672697688, 0.0016165172493990748, 0.0016118976714697333, 0.00036742497738726334, 0.00039227767398757914, 0.0018087194362611627, 0.0005987931489346237, 0.0018080818421458583, 0.00039363608155117136, 0.0018087194362611633, 0.005647325444573097, 0.005655106363034929, 0.001806714151027889, 0.0005987931489346229, 0.005655106363034937, 0.000596692777546526, 0.001808081842145857, 0.001806714151027889, 0.0003936360815511719, 0.00041742340146128836, 0.001144974434121019, 0.0011436708638168883, 0.0004173452552431766, 0.0011449744341210197, 0.00892110304805322, 0.0011469607705917317, 0.001143670863816889, 0.0011469607705917313, 0.0004173452552431772, 0.00023359096930042166, 0.0019152121938112636, 0.0002323022212338399, 0.0019152121938112634, 0.0019191327390805084, 0.00023230222123383983, 0.0005131087925300033, 0.0005119066782702684, 0.0005119066782702685, 0.00021829161858727522])
    cub_degree = 7
    tol = tol
    #680 nodes /15 numedgenodes
    # edgeparams = T[-1.0, -0.8571428571428572, -0.7142857142857144, -0.5714285714285714, -0.4285714285714286, -0.2857142857142858, -0.14285714285714285, 0.0, 0.14285714285714285, 0.2857142857142858, 0.4285714285714286, 0.5714285714285714, 0.7142857142857144, 0.8571428571428572, 1.0]
    # cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    # AsymCubatures.setparams!(cub, edgeparams)
    # AsymCubatures.setweights!(cub, T[0.00014164381880470934, 0.0004124251509026379, 0.00013609171957733754, 0.0003320759822551802, 0.00026373952129868855, 0.00030443302187747423, 0.000293600965683985, 0.00028472726171535026, 0.00028350188461138254, 0.00029042444418674057, 0.0002548678446217263, 0.0003335549684964088, 0.00014196402684705373, 0.0004038088261268883, 0.00012740108401046769, 0.00041242515090263783, 0.001713624722993829, 0.0007601662517279732, 0.0016208909950004569, 0.0012075214627616107, 0.001302862872271376, 0.001242257298328655, 0.0012372486943570328, 0.0012906935494416594, 0.0011958586341287358, 0.0016209298774594791, 0.0007788673620059575, 0.0017403230434103443, 0.0004157980218558707, 0.00013609171957733635, 0.0007601662517279732, 0.00037433354323744127, 0.0007173451577499207, 0.0004792482907599223, 0.0004994949377105304, 0.0004796325197142285, 0.0005043123263184313, 0.0004778641579447708, 0.0007016045512159252, 0.0003568236807021765, 0.000775791922101896, 0.00015879261853762405, 0.0003320759822551818, 0.0016208909950004564, 0.0007173451577499211, 0.0013672714114025635, 0.0009689252046760137, 0.0011095758338414451, 0.0011220788386480912, 0.000991688022349156, 0.001369581434987173, 0.0006890515522138202, 0.0016017652703789163, 0.00034686277888807386, 0.0002637395212986872, 0.0012075214627616073, 0.0004792482907599226, 0.0009689252046760134, 0.0007492645620668648, 0.0008943119530421833, 0.0007915356552182446, 0.001012507574458568, 0.0004810064004199343, 0.0011735687177776856, 0.00026027040761158056, 0.0003044330218774753, 0.0013028628722713755, 0.0004994949377105318, 0.0011095758338414462, 0.0008943119530421832, 0.0010242621888390535, 0.0011778110252144776, 0.0005416406179439715, 0.0012799030855512002, 0.00028625782143021166, 0.0002936009656839858, 0.0012422572983286566, 0.000479632519714229, 0.0011220788386480923, 0.0007915356552182454, 0.0011778110252144765, 0.0005368006484184619, 0.0012358939958119722, 0.00026980488978925715, 0.0002847272617153495, 0.0012372486943570328, 0.0005043123263184313, 0.0009916880223491582, 0.0010125075744585657, 0.0005416406179439697, 0.001235893995811972, 0.0002633681165337311, 0.00028350188461138357, 0.001290693549441658, 0.00047786415794476945, 0.001369581434987174, 0.00048100640041993475, 0.0012799030855512002, 0.00026980488978925736, 0.00029042444418674073, 0.0011958586341287338, 0.0007016045512159242, 0.00068905155221382, 0.0011735687177776848, 0.0002862578214302118, 0.00025486784462172644, 0.0016209298774594772, 0.00035682368070217717, 0.0016017652703789165, 0.00026027040761158137, 0.0003335549684964081, 0.0007788673620059573, 0.0007757919221018958, 0.00034686277888807435, 0.0001419640268470544, 0.0017403230434103428, 0.00015879261853762416, 0.000403808826126889, 0.0004157980218558707, 0.00012740108401046826, 0.00041242515090263724, 0.0017136247229938277, 0.0007601662517279715, 0.0016208909950004564, 0.0012075214627616068, 0.0013028628722713742, 0.0012422572983286548, 0.0012372486943570315, 0.0012906935494416572, 0.0011958586341287323, 0.0016209298774594754, 0.0007788673620059563, 0.0017403230434103424, 0.0004157980218558692, 0.0017136247229938295, 0.007912264748127892, 0.0037485492162987175, 0.0072627184712763535, 0.005317639007806083, 0.005854411562699266, 0.00578685764783627, 0.0059134437146710385, 0.005399878483435538, 0.007313445074865478, 0.0037475827402952437, 0.007881318904185523, 0.0017034537424317846, 0.000760166251727972, 0.0037485492162987123, 0.0016705506159163713, 0.0030579739650199544, 0.0022531843146600217, 0.0026578480446535465, 0.0026857330597633887, 0.002307917896418898, 0.003076052493246034, 0.0016168721934087863, 0.0036691366418970385, 0.0007473400822314363, 0.001620890995000456, 0.0072627184712763465, 0.0030579739650199514, 0.006132519955411551, 0.00471047090040706, 0.00538955217080613, 0.004693487423451995, 0.006093913157198436, 0.0030025896802962217, 0.007228696020332794, 0.0016226293643321745, 0.0012075214627616073, 0.005317639007806081, 0.0022531843146600247, 0.004710470900407062, 0.0037924333757285104, 0.004140620376290036, 0.004632165108554023, 0.00221028157120738, 0.00535744391448194, 0.0012284780394602886, 0.0013028628722713766, 0.005854411562699269, 0.002657848044653549, 0.005389552170806131, 0.0041406203762900376, 0.004362255444772949, 0.0026099189767902022, 0.005935117021775002, 0.0013394299343335257, 0.0012422572983286561, 0.005786857647836274, 0.0026857330597633918, 0.004693487423451993, 0.00463216510855402, 0.0026099189767902014, 0.0058623372293709255, 0.0012900453227818218, 0.001237248694357032, 0.005913443714671038, 0.0023079178964188958, 0.006093913157198434, 0.002210281571207378, 0.005935117021775001, 0.001290045322781822, 0.0012906935494416583, 0.005399878483435533, 0.0030760524932460314, 0.003002589680296221, 0.005357443914481941, 0.0013394299343335257, 0.001195858634128734, 0.007313445074865478, 0.001616872193408787, 0.007228696020332797, 0.0012284780394602882, 0.0016209298774594778, 0.003747582740295241, 0.00366913664189704, 0.0016226293643321764, 0.000778867362005958, 0.007881318904185522, 0.0007473400822314384, 0.001740323043410344, 0.0017034537424317855, 0.00041579802185587084, 0.00013609171957733608, 0.0007601662517279715, 0.00037433354323744046, 0.0007173451577499204, 0.00047924829075992047, 0.0004994949377105304, 0.0004796325197142276, 0.0005043123263184299, 0.00047786415794477124, 0.0007016045512159234, 0.00035682368070217636, 0.0007757919221018945, 0.0001587926185376234, 0.0007601662517279723, 0.0037485492162987145, 0.0016705506159163737, 0.003057973965019955, 0.0022531843146600256, 0.0026578480446535447, 0.002685733059763392, 0.0023079178964188984, 0.0030760524932460336, 0.0016168721934087865, 0.00366913664189704, 0.0007473400822314365, 0.0003743335432374402, 0.0016705506159163663, 0.00030918543320657566, 0.0009336612861283387, 0.0008857681629585873, 0.0012097991652017107, 0.0008775954174545852, 0.0009378475690290954, 0.00034363808175142746, 0.001702648054803253, 0.00035838369659976375, 0.00071734515774992, 0.00305797396501995, 0.0009336612861283376, 0.0025206489028592374, 0.0021248152624252655, 0.0023127158208923037, 0.002453518366361917, 0.000989185916475981, 0.0032196528789538974, 0.0007265442164246729, 0.0004792482907599214, 0.0022531843146600225, 0.0008857681629585879, 0.0021248152624252655, 0.0016892334083246272, 0.0016491323583757006, 0.000894529182268725, 0.0024299850099237315, 0.0004896225185098103, 0.000499494937710531, 0.0026578480446535473, 0.001209799165201714, 0.002312715820892304, 0.0016491323583757006, 0.0019122377326792192, 0.0027737363845713667, 0.00048789426355188545, 0.0004796325197142282, 0.00268573305976339, 0.0008775954174545854, 0.0024535183663619165, 0.0008945291822687225, 0.002773736384571364, 0.00045236069150027757, 0.0005043123263184302, 0.0023079178964188945, 0.0009378475690290943, 0.0009891859164759802, 0.0024299850099237298, 0.0004878942635518846, 0.00047786415794477037, 0.0030760524932460323, 0.0003436380817514282, 0.0032196528789538983, 0.0004896225185098102, 0.0007016045512159247, 0.0016168721934087858, 0.0017026480548032541, 0.0007265442164246735, 0.0003568236807021773, 0.0036691366418970376, 0.00035838369659976457, 0.0007757919221018959, 0.0007473400822314359, 0.00015879261853762424, 0.00033207598225518163, 0.001620890995000455, 0.0007173451577499203, 0.0013672714114025646, 0.0009689252046760122, 0.0011095758338414458, 0.0011220788386480916, 0.0009916880223491563, 0.0013695814349871742, 0.0006890515522138204, 0.0016017652703789159, 0.00034686277888807353, 0.001620890995000456, 0.007262718471276348, 0.003057973965019953, 0.006132519955411553, 0.004710470900407059, 0.00538955217080613, 0.004693487423451997, 0.006093913157198436, 0.0030025896802962195, 0.007228696020332793, 0.0016226293643321749, 0.0007173451577499198, 0.003057973965019948, 0.0009336612861283369, 0.0025206489028592348, 0.002124815262425263, 0.0023127158208923024, 0.002453518366361917, 0.0009891859164759798, 0.003219652878953897, 0.000726544216424673, 0.0013672714114025635, 0.006132519955411547, 0.002520648902859236, 0.00553358223230382, 0.004154279279928667, 0.004445723651198307, 0.002588101588253607, 0.0063015421309284576, 0.0013328183949658785, 0.0009689252046760124, 0.00471047090040706, 0.002124815262425264, 0.004154279279928671, 0.0030500807962057586, 0.003466666407780835, 0.004731835731560122, 0.0008237053776794347, 0.0011095758338414469, 0.005389552170806131, 0.0023127158208923046, 0.004445723651198309, 0.003466666407780833, 0.003934598394878503, 0.0008654809739304473, 0.0011220788386480918, 0.004693487423451994, 0.002453518366361916, 0.0025881015882536053, 0.004731835731560123, 0.000865480973930448, 0.0009916880223491571, 0.006093913157198434, 0.0009891859164759798, 0.006301542130928458, 0.0008237053776794359, 0.0013695814349871734, 0.0030025896802962173, 0.0032196528789538974, 0.001332818394965878, 0.0006890515522138204, 0.0072286960203327925, 0.0007265442164246724, 0.001601765270378917, 0.0016226293643321745, 0.00034686277888807397, 0.0002637395212986871, 0.0012075214627616066, 0.0004792482907599209, 0.000968925204676013, 0.0007492645620668638, 0.0008943119530421821, 0.0007915356552182438, 0.001012507574458568, 0.00048100640041993443, 0.0011735687177776848, 0.00026027040761158066, 0.001207521462761608, 0.0053176390078060794, 0.002253184314660023, 0.004710470900407062, 0.003792433375728508, 0.004140620376290032, 0.004632165108554021, 0.0022102815712073784, 0.005357443914481939, 0.0012284780394602882, 0.0004792482907599213, 0.002253184314660021, 0.0008857681629585851, 0.002124815262425262, 0.0016892334083246246, 0.0016491323583756976, 0.0008945291822687223, 0.0024299850099237293, 0.0004896225185098101, 0.0009689252046760114, 0.004710470900407059, 0.002124815262425263, 0.00415427927992867, 0.0030500807962057586, 0.0034666664077808336, 0.0047318357315601235, 0.0008237053776794355, 0.0007492645620668647, 0.0037924333757285086, 0.0016892334083246261, 0.003050080796205759, 0.002499792367711903, 0.002695558049898103, 0.0003859022590336018, 0.0008943119530421817, 0.004140620376290033, 0.0016491323583756995, 0.0034666664077808327, 0.002695558049898102, 0.0022970158152921826, 0.0007915356552182447, 0.004632165108554022, 0.0008945291822687218, 0.004731835731560122, 0.00038590225903360195, 0.0010125075744585668, 0.0022102815712073754, 0.0024299850099237298, 0.0008237053776794351, 0.00048100640041993573, 0.005357443914481936, 0.0004896225185098094, 0.0011735687177776852, 0.001228478039460288, 0.00026027040761158137, 0.000304433021877475, 0.0013028628722713755, 0.0004994949377105309, 0.001109575833841447, 0.0008943119530421814, 0.0010242621888390529, 0.0011778110252144765, 0.0005416406179439699, 0.0012799030855511996, 0.000286257821430211, 0.001302862872271375, 0.0058544115626992625, 0.002657848044653548, 0.00538955217080613, 0.004140620376290032, 0.004362255444772951, 0.002609918976790202, 0.005935117021774998, 0.001339429934333526, 0.0004994949377105306, 0.002657848044653545, 0.0012097991652017122, 0.002312715820892303, 0.0016491323583756982, 0.0019122377326792187, 0.002773736384571365, 0.00048789426355188496, 0.001109575833841446, 0.00538955217080613, 0.0023127158208923037, 0.00444572365119831, 0.003466666407780833, 0.003934598394878502, 0.0008654809739304472, 0.0008943119530421829, 0.004140620376290034, 0.0016491323583757002, 0.003466666407780834, 0.0026955580498981033, 0.002297015815292182, 0.0010242621888390537, 0.00436225544477295, 0.0019122377326792192, 0.003934598394878504, 0.002297015815292181, 0.0011778110252144765, 0.0026099189767902005, 0.002773736384571366, 0.0008654809739304476, 0.0005416406179439705, 0.005935117021774999, 0.00048789426355188545, 0.0012799030855512, 0.0013394299343335264, 0.0002862578214302121, 0.00029360096568398556, 0.0012422572983286561, 0.0004796325197142291, 0.001122078838648093, 0.0007915356552182447, 0.001177811025214476, 0.0005368006484184609, 0.0012358939958119718, 0.00026980488978925715, 0.0012422572983286553, 0.005786857647836276, 0.002685733059763392, 0.004693487423451996, 0.004632165108554022, 0.0026099189767902035, 0.005862337229370928, 0.0012900453227818226, 0.0004796325197142289, 0.002685733059763392, 0.0008775954174545876, 0.0024535183663619174, 0.0008945291822687244, 0.002773736384571368, 0.00045236069150027714, 0.0011220788386480925, 0.004693487423451998, 0.002453518366361917, 0.002588101588253608, 0.004731835731560125, 0.0008654809739304474, 0.0007915356552182436, 0.004632165108554021, 0.0008945291822687236, 0.0047318357315601235, 0.0003859022590336027, 0.0011778110252144763, 0.002609918976790201, 0.002773736384571367, 0.0008654809739304484, 0.0005368006484184615, 0.005862337229370929, 0.0004523606915002788, 0.0012358939958119733, 0.0012900453227818241, 0.0002698048897892579, 0.0002847272617153499, 0.0012372486943570324, 0.0005043123263184318, 0.000991688022349156, 0.0010125075744585673, 0.0005416406179439708, 0.0012358939958119735, 0.0002633681165337311, 0.0012372486943570326, 0.005913443714671039, 0.0023079178964188984, 0.006093913157198436, 0.0022102815712073797, 0.005935117021775004, 0.0012900453227818222, 0.0005043123263184313, 0.0023079178964188992, 0.0009378475690290958, 0.000989185916475982, 0.0024299850099237337, 0.00048789426355188545, 0.0009916880223491574, 0.006093913157198439, 0.0009891859164759813, 0.006301542130928462, 0.0008237053776794364, 0.0010125075744585677, 0.002210281571207378, 0.002429985009923733, 0.0008237053776794368, 0.0005416406179439702, 0.005935117021775004, 0.0004878942635518862, 0.0012358939958119744, 0.001290045322781823, 0.0002633681165337317, 0.00028350188461138373, 0.0012906935494416594, 0.0004778641579447715, 0.0013695814349871738, 0.0004810064004199354, 0.0012799030855512007, 0.0002698048897892573, 0.0012906935494416583, 0.0053998784834355384, 0.003076052493246032, 0.00300258968029622, 0.005357443914481942, 0.0013394299343335264, 0.00047786415794477075, 0.003076052493246032, 0.00034363808175142703, 0.0032196528789538996, 0.0004896225185098096, 0.001369581434987174, 0.003002589680296219, 0.0032196528789538983, 0.0013328183949658783, 0.0004810064004199351, 0.005357443914481937, 0.0004896225185098108, 0.0012799030855512004, 0.001339429934333526, 0.00026980488978925736, 0.0002904244441867411, 0.0011958586341287345, 0.0007016045512159246, 0.0006890515522138208, 0.0011735687177776867, 0.0002862578214302117, 0.001195858634128734, 0.007313445074865475, 0.0016168721934087843, 0.007228696020332793, 0.0012284780394602882, 0.0007016045512159241, 0.001616872193408784, 0.0017026480548032535, 0.0007265442164246733, 0.0006890515522138207, 0.007228696020332796, 0.0007265442164246731, 0.0011735687177776867, 0.0012284780394602884, 0.0002862578214302116, 0.0002548678446217269, 0.001620929877459477, 0.0003568236807021768, 0.0016017652703789174, 0.00026027040761158104, 0.001620929877459477, 0.00374758274029524, 0.0036691366418970394, 0.001622629364332175, 0.00035682368070217717, 0.00366913664189704, 0.0003583836965997636, 0.0016017652703789172, 0.0016226293643321753, 0.00026027040761158094, 0.0003335549684964083, 0.0007788673620059577, 0.0007757919221018965, 0.0003468627788880745, 0.0007788673620059579, 0.007881318904185522, 0.0007473400822314379, 0.0007757919221018975, 0.0007473400822314375, 0.0003468627788880742, 0.00014196402684705462, 0.0017403230434103441, 0.00015879261853762457, 0.0017403230434103443, 0.0017034537424317866, 0.00015879261853762476, 0.0004038088261268886, 0.0004157980218558706, 0.00041579802185587095, 0.0001274010840104679])
    # cub_degree = 7
    # tol = tol
  elseif q<=8 #969 nodes /17 numedgenodes
    edgeparams = T[-1.0, -0.875, -0.75, -0.625, -0.5, -0.375, -0.25, -0.125, 0.0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[1.7965474366912448e-5, 0.00025980925602844476, 0.0001090883458000172, 0.00021311151203465267, 0.0001582845237030345, 0.00019518729647496436, 0.00019307032104914316, 0.00018094142150690783, 0.000173701451595538, 0.0001805886838167026, 0.0001925143819638409, 0.00019455759811958938, 0.00015752446427736466, 0.0002120767605180272, 0.0001080561264443375, 0.000260125532127024, 1.9113495607837347e-5, 0.00025980925602844465, 0.0013082880114792883, 0.0005250613428023384, 0.0010147083258251102, 0.000795946087184725, 0.0009268645230950266, 0.0008760474124262782, 0.0008175633685776031, 0.0008176128138845135, 0.0008764654842982094, 0.0009281072339859162, 0.0007979771562100559, 0.0010163963459769866, 0.0005250005861143494, 0.0013067459436315073, 0.00025978772780986596, 0.00010908834580001666, 0.0005250613428023357, 0.00012115165821576124, 0.00039094782415973356, 0.0003491357803082602, 0.0003954804915153473, 0.0003216514527559985, 0.0002799249704560386, 0.0003216794651380254, 0.00039594062063405745, 0.00035045441425874513, 0.0003929575266003745, 0.0001226935925587392, 0.0005242904474135851, 0.00010791678830417781, 0.00021311151203465332, 0.0010147083258251084, 0.0003909478241597339, 0.0009203348055209083, 0.0007112230469276877, 0.0007619117861218728, 0.0006954792405393064, 0.0006951970327453424, 0.000761160656349259, 0.0007103486772921535, 0.0009200403989269769, 0.0003916727375804199, 0.0010153191058069, 0.00021240305835817464, 0.00015828452370303405, 0.0007959460871847244, 0.00034913578030825956, 0.0007112230469276893, 0.0005307048014787008, 0.0005639993344860489, 0.0005377399711383448, 0.0005633854798386797, 0.0005293377743326021, 0.0007095880481058917, 0.00034855233292138357, 0.0007968969959757025, 0.00015822702211080786, 0.00019518729647496444, 0.000926864523095027, 0.0003954804915153488, 0.000761911786121874, 0.000563999334486049, 0.0006394036675255885, 0.0006393715950494124, 0.0005635442380071075, 0.0007607367670355437, 0.00039448094251555167, 0.0009274014227688579, 0.00019537355188300348, 0.00019307032104914375, 0.0008760474124262788, 0.00032165145275599817, 0.0006954792405393077, 0.0005377399711383459, 0.0006393715950494129, 0.0005380065456287563, 0.00069529584421374, 0.0003210551371783289, 0.0008761879143686704, 0.0001931831029955393, 0.0001809414215069079, 0.0008175633685776026, 0.0002799249704560365, 0.0006951970327453435, 0.0005633854798386793, 0.0005635442380071068, 0.0006952958442137403, 0.00027966403492048816, 0.0008175769953356922, 0.00018096513677386076, 0.0001737014515955372, 0.0008176128138845138, 0.0003216794651380256, 0.0007611606563492592, 0.0005293377743326032, 0.0007607367670355431, 0.00032105513717832864, 0.0008175769953356918, 0.00017381394074835504, 0.00018058868381670291, 0.0008764654842982085, 0.000395940620634058, 0.0007103486772921533, 0.0007095880481058908, 0.0003944809425155511, 0.0008761879143686702, 0.00018096513677386063, 0.00019251438196384035, 0.000928107233985916, 0.0003504544142587459, 0.0009200403989269779, 0.00034855233292138243, 0.0009274014227688577, 0.00019318310299553908, 0.00019455759811958995, 0.000797977156210057, 0.0003929575266003733, 0.00039167273758041946, 0.0007968969959757042, 0.00019537355188300342, 0.00015752446427736553, 0.001016396345976986, 0.00012269359255873914, 0.0010153191058069019, 0.00015822702211080824, 0.00021207676051802636, 0.0005250005861143475, 0.0005242904474135868, 0.0002124030583581748, 0.00010805612644433722, 0.0013067459436315076, 0.0001079167883041784, 0.00026012553212702446, 0.0002597877278098656, 1.9113495607837354e-5, 0.0002598092560284443, 0.001308288011479287, 0.0005250613428023365, 0.001014708325825109, 0.0007959460871847236, 0.0009268645230950264, 0.0008760474124262775, 0.0008175633685776018, 0.000817612813884514, 0.0008764654842982073, 0.0009281072339859145, 0.0007979771562100556, 0.0010163963459769846, 0.0005250005861143483, 0.0013067459436315052, 0.00025978772780986537, 0.0013082880114792888, 0.005701152861742888, 0.002321768039926059, 0.004751346163772738, 0.0038093014815977484, 0.004213626788821958, 0.003886866708446985, 0.0037187311989286894, 0.0038849780700279633, 0.00421144470371086, 0.003808704813105777, 0.004753122180851981, 0.002324109939143956, 0.005700415641848584, 0.0013066212165434496, 0.000525061342802336, 0.002321768039926054, 0.0007918188799596775, 0.0021097680275607377, 0.001779947218471499, 0.0018028688098527348, 0.001499344903235994, 0.0014982721327880162, 0.0017993853307310239, 0.001774222286027342, 0.0021046340350479903, 0.0007915190273863156, 0.0023262128274969406, 0.0005250826550155097, 0.0010147083258251087, 0.0047513461637727315, 0.0021097680275607403, 0.004349657820976941, 0.0032626940632708404, 0.0034502609952398143, 0.003288963807499692, 0.003450576683492393, 0.00326007471814084, 0.004343305994577379, 0.0021055811892949565, 0.004755872848512794, 0.0010163966008651896, 0.0007959460871847241, 0.003809301481597748, 0.0017799472184715003, 0.0032626940632708426, 0.002443633928023354, 0.0026878068364928035, 0.0026901552220999, 0.002446950323411395, 0.003261204013994691, 0.0017754374576363972, 0.003810799717943887, 0.0007976534577020439, 0.0009268645230950268, 0.00421362678882196, 0.0018028688098527372, 0.0034502609952398186, 0.0026878068364928017, 0.00306085663055912, 0.0026935031276084636, 0.003454276673683742, 0.0018016954038709665, 0.004213029295981448, 0.0009274580262513285, 0.0008760474124262782, 0.003886866708446987, 0.001499344903235994, 0.003288963807499692, 0.0026901552220998984, 0.0026935031276084658, 0.0032949706981576185, 0.001501650977212636, 0.0038862841186336483, 0.0008755334542407336, 0.0008175633685776016, 0.003718731198928685, 0.0014982721327880145, 0.003450576683492392, 0.002446950323411393, 0.003454276673683741, 0.0015016509772126359, 0.0037192227637753354, 0.0008164939070603554, 0.0008176128138845137, 0.0038849780700279616, 0.001799385330731022, 0.0032600747181408393, 0.0032612040139946893, 0.001801695403870964, 0.003886284118633652, 0.000816493907060355, 0.000876465484298208, 0.004211444703710866, 0.0017742222860273416, 0.00434330599457738, 0.001775437457636397, 0.004213029295981446, 0.0008755334542407329, 0.0009281072339859155, 0.003808704813105778, 0.002104634035047987, 0.002105581189294958, 0.003810799717943887, 0.0009274580262513287, 0.000797977156210057, 0.0047531221808519795, 0.0007915190273863145, 0.004755872848512798, 0.0007976534577020445, 0.0010163963459769848, 0.002324109939143952, 0.0023262128274969427, 0.0010163966008651913, 0.0005250005861143479, 0.005700415641848584, 0.0005250826550155101, 0.0013067459436315073, 0.0013066212165434496, 0.00025978772780986585, 0.000109088345800016, 0.000525061342802335, 0.00012115165821576009, 0.0003909478241597326, 0.00034913578030825837, 0.000395480491515347, 0.0003216514527559966, 0.00027992497045603663, 0.0003216794651380242, 0.0003959406206340568, 0.0003504544142587447, 0.00039295752660037256, 0.0001226935925587394, 0.0005242904474135845, 0.0001079167883041776, 0.0005250613428023364, 0.0023217680399260543, 0.0007918188799596775, 0.002109768027560739, 0.0017799472184714979, 0.0018028688098527348, 0.0014993449032359937, 0.0014982721327880162, 0.001799385330731023, 0.0017742222860273422, 0.0021046340350479877, 0.0007915190273863162, 0.0023262128274969397, 0.0005250826550155102, 0.00012115165821575967, 0.0007918188799596733, 0.00011364839664646478, 0.0008000652425302504, 0.0006094296383628369, 0.0004827160081692526, 0.0003295720829580608, 0.00048641688320398677, 0.0006109481849694083, 0.0007955444753029106, 0.0001083725115928765, 0.0007948769833308133, 0.00012266995922642052, 0.0003909478241597331, 0.002109768027560737, 0.0008000652425302511, 0.0017390445926187882, 0.0012375477906233596, 0.001352201002781225, 0.0013585169064663375, 0.001249856554394501, 0.0017445915617435876, 0.0007960924550441137, 0.002106974739566217, 0.0003912096573245661, 0.0003491357803082596, 0.001779947218471499, 0.000609429638362839, 0.0012375477906233614, 0.0010239742629497529, 0.0012352917224936416, 0.0010374918534784513, 0.001250149411078892, 0.0006102346250692528, 0.0017743870631360555, 0.0003477535824901509, 0.00039548049151534777, 0.0018028688098527357, 0.00048271600816925304, 0.001352201002781226, 0.0012352917224936419, 0.0013704379115981498, 0.0013631513943728614, 0.00048666991572018887, 0.0017989343576573424, 0.00039360251492831196, 0.0003216514527559978, 0.001499344903235993, 0.00032957208295806054, 0.0013585169064663375, 0.001037491853478452, 0.0013631513943728594, 0.00033262485095572435, 0.001498084424261749, 0.0003202433341958472, 0.000279924970456036, 0.001498272132788014, 0.0004864168832039858, 0.0012498565543944992, 0.0012501494110788913, 0.0004866699157201871, 0.0014980844242617494, 0.00027889835948910306, 0.0003216794651380237, 0.0017993853307310228, 0.0006109481849694081, 0.0017445915617435859, 0.0006102346250692514, 0.0017989343576573415, 0.00032024333419584597, 0.0003959406206340581, 0.0017742222860273442, 0.0007955444753029099, 0.0007960924550441117, 0.001774387063136058, 0.00039360251492831153, 0.0003504544142587459, 0.002104634035047988, 0.0001083725115928745, 0.002106974739566218, 0.00034775358249015134, 0.00039295752660037337, 0.0007915190273863131, 0.0007948769833308137, 0.00039120965732456734, 0.00012269359255873938, 0.00232621282749694, 0.00012266995922642103, 0.0005242904474135861, 0.0005250826550155097, 0.00010791678830417847, 0.0002131115120346529, 0.0010147083258251082, 0.00039094782415973275, 0.0009203348055209084, 0.0007112230469276872, 0.0007619117861218724, 0.000695479240539305, 0.0006951970327453421, 0.0007611606563492577, 0.0007103486772921532, 0.0009200403989269774, 0.0003916727375804191, 0.0010153191058068995, 0.00021240305835817407, 0.0010147083258251093, 0.004751346163772733, 0.0021097680275607403, 0.004349657820976941, 0.0032626940632708434, 0.0034502609952398147, 0.0032889638074996923, 0.0034505766834923932, 0.003260074718140842, 0.004343305994577382, 0.002105581189294959, 0.004755872848512794, 0.0010163966008651904, 0.00039094782415973264, 0.002109768027560736, 0.0008000652425302504, 0.0017390445926187884, 0.0012375477906233603, 0.0013522010027812244, 0.0013585169064663366, 0.0012498565543944992, 0.0017445915617435872, 0.0007960924550441127, 0.0021069747395662166, 0.0003912096573245666, 0.0009203348055209083, 0.0043496578209769364, 0.0017390445926187895, 0.0035752805854755297, 0.0027123598626956897, 0.003117663853611478, 0.0027293010590646524, 0.003591583296012698, 0.0017416707680007314, 0.004342426916392679, 0.0009179755217450147, 0.0007112230469276888, 0.0032626940632708417, 0.0012375477906233618, 0.002712359862695692, 0.00226900121141221, 0.0025077759826828048, 0.002727498758300423, 0.0012442133942104814, 0.003258620994961105, 0.0007089901675893067, 0.0007619117861218731, 0.0034502609952398156, 0.0013522010027812253, 0.0031176638536114794, 0.0025077759826828043, 0.0025558534458374987, 0.0013559028802419466, 0.0034519434031350014, 0.000762452077897455, 0.0006954792405393054, 0.0032889638074996923, 0.0013585169064663375, 0.0027293010590646546, 0.002727498758300423, 0.001355902880241946, 0.003292886947583201, 0.0006986910334826064, 0.000695197032745343, 0.003450576683492391, 0.0012498565543945003, 0.0035915832960126994, 0.0012442133942104803, 0.003451943403135, 0.0006986910334826062, 0.0007611606563492591, 0.003260074718140842, 0.001744591561743586, 0.00174167076800073, 0.003258620994961107, 0.0007624520778974547, 0.0007103486772921542, 0.004343305994577381, 0.0007960924550441117, 0.004342426916392681, 0.000708990167589307, 0.0009200403989269779, 0.0021055811892949556, 0.0021069747395662175, 0.0009179755217450154, 0.0003916727375804197, 0.004755872848512794, 0.0003912096573245668, 0.0010153191058069006, 0.0010163966008651902, 0.0002124030583581747, 0.00015828452370303405, 0.0007959460871847236, 0.0003491357803082598, 0.0007112230469276888, 0.0005307048014787012, 0.0005639993344860467, 0.0005377399711383451, 0.0005633854798386798, 0.0005293377743326022, 0.0007095880481058908, 0.00034855233292138254, 0.0007968969959757023, 0.00015822702211080772, 0.0007959460871847241, 0.003809301481597748, 0.0017799472184715018, 0.0032626940632708434, 0.0024436339280233554, 0.002687806836492802, 0.0026901552220999006, 0.002446950323411396, 0.0032612040139946914, 0.0017754374576363992, 0.003810799717943887, 0.0007976534577020447, 0.00034913578030825945, 0.0017799472184714983, 0.0006094296383628378, 0.0012375477906233603, 0.0010239742629497516, 0.0012352917224936401, 0.0010374918534784493, 0.0012501494110788922, 0.000610234625069252, 0.001774387063136055, 0.000347753582490151, 0.0007112230469276884, 0.00326269406327084, 0.0012375477906233605, 0.002712359862695692, 0.0022690012114122094, 0.0025077759826828035, 0.0027274987583004234, 0.0012442133942104814, 0.0032586209949611042, 0.0007089901675893076, 0.0005307048014787017, 0.0024436339280233532, 0.0010239742629497542, 0.00226900121141221, 0.0019426297035534344, 0.0019025215619755333, 0.0010288168271862643, 0.0024478378851333724, 0.0005325173450359902, 0.0005639993344860482, 0.0026878068364928017, 0.0012352917224936419, 0.0025077759826828043, 0.0019025215619755328, 0.001935614858423105, 0.0026975186187472334, 0.0005714517595093909, 0.0005377399711383455, 0.0026901552220999006, 0.0010374918534784493, 0.002727498758300422, 0.0010288168271862632, 0.002697518618747234, 0.0005479680750743483, 0.0005633854798386775, 0.002446950323411396, 0.0012501494110788926, 0.0012442133942104805, 0.002447837885133373, 0.000571451759509392, 0.0005293377743326031, 0.0032612040139946897, 0.0006102346250692509, 0.003258620994961107, 0.0005325173450359898, 0.0007095880481058915, 0.0017754374576363981, 0.001774387063136057, 0.0007089901675893078, 0.0003485523329213834, 0.0038107997179438876, 0.00034775358249015167, 0.0007968969959757031, 0.0007976534577020435, 0.00015822702211080815, 0.0001951872964749643, 0.0009268645230950263, 0.00039548049151534766, 0.0007619117861218729, 0.000563999334486049, 0.0006394036675255883, 0.0006393715950494121, 0.0005635442380071055, 0.0007607367670355423, 0.0003944809425155515, 0.0009274014227688571, 0.00019537355188300326, 0.0009268645230950268, 0.00421362678882196, 0.001802868809852737, 0.0034502609952398165, 0.002687806836492803, 0.0030608566305591173, 0.0026935031276084684, 0.0034542766736837417, 0.0018016954038709663, 0.004213029295981446, 0.0009274580262513292, 0.00039548049151534733, 0.0018028688098527341, 0.00048271600816925244, 0.001352201002781226, 0.0012352917224936401, 0.0013704379115981478, 0.0013631513943728596, 0.0004866699157201877, 0.0017989343576573407, 0.00039360251492831066, 0.0007619117861218724, 0.003450260995239816, 0.0013522010027812257, 0.0031176638536114794, 0.002507775982682803, 0.0025558534458374987, 0.0013559028802419466, 0.003451943403135, 0.0007624520778974545, 0.0005639993344860482, 0.002687806836492804, 0.001235291722493643, 0.002507775982682805, 0.0019025215619755326, 0.0019356148584231063, 0.0026975186187472334, 0.0005714517595093932, 0.0006394036675255893, 0.00306085663055912, 0.0013704379115981502, 0.002555853445837499, 0.0019356148584231045, 0.00231169625509388, 0.0006524659725608991, 0.0006393715950494131, 0.0026935031276084675, 0.0013631513943728588, 0.0013559028802419457, 0.0026975186187472334, 0.0006524659725608986, 0.000563544238007108, 0.0034542766736837417, 0.0004866699157201874, 0.0034519434031350014, 0.0005714517595093908, 0.0007607367670355425, 0.0018016954038709654, 0.0017989343576573428, 0.0007624520778974558, 0.00039448094251555145, 0.004213029295981447, 0.00039360251492831223, 0.0009274014227688574, 0.0009274580262513285, 0.00019537355188300348, 0.00019307032104914362, 0.0008760474124262778, 0.000321651452755998, 0.0006954792405393065, 0.0005377399711383456, 0.0006393715950494121, 0.0005380065456287553, 0.0006952958442137402, 0.0003210551371783285, 0.0008761879143686695, 0.00019318310299553903, 0.0008760474124262782, 0.0038868667084469874, 0.0014993449032359946, 0.0032889638074996923, 0.0026901552220999, 0.002693503127608467, 0.003294970698157616, 0.001501650977212638, 0.0038862841186336518, 0.0008755334542407341, 0.00032165145275599746, 0.0014993449032359924, 0.0003295720829580593, 0.0013585169064663383, 0.0010374918534784504, 0.0013631513943728596, 0.00033262485095572446, 0.001498084424261751, 0.00032024333419584683, 0.0006954792405393061, 0.003288963807499693, 0.0013585169064663386, 0.0027293010590646555, 0.002727498758300425, 0.0013559028802419466, 0.003292886947583201, 0.0006986910334826071, 0.0005377399711383452, 0.002690155222099902, 0.0010374918534784524, 0.0027274987583004247, 0.0010288168271862656, 0.0026975186187472347, 0.0005479680750743489, 0.0006393715950494126, 0.0026935031276084697, 0.0013631513943728598, 0.0013559028802419457, 0.002697518618747234, 0.000652465972560899, 0.0005380065456287557, 0.0032949706981576145, 0.0003326248509557229, 0.0032928869475832025, 0.0005479680750743486, 0.0006952958442137398, 0.001501650977212636, 0.0014980844242617503, 0.0006986910334826069, 0.0003210551371783295, 0.0038862841186336518, 0.0003202433341958469, 0.0008761879143686701, 0.0008755334542407343, 0.00019318310299553895, 0.00018094142150690767, 0.0008175633685776019, 0.0002799249704560371, 0.0006951970327453436, 0.0005633854798386775, 0.0005635442380071073, 0.0006952958442137398, 0.00027966403492048767, 0.0008175769953356916, 0.00018096513677386055, 0.0008175633685776022, 0.0037187311989286863, 0.0014982721327880155, 0.003450576683492393, 0.002446950323411395, 0.003454276673683742, 0.0015016509772126374, 0.0037192227637753367, 0.0008164939070603547, 0.0002799249704560367, 0.0014982721327880147, 0.00048641688320398725, 0.0012498565543945007, 0.0012501494110788932, 0.0004866699157201883, 0.0014980844242617499, 0.0002788983594891026, 0.0006951970327453433, 0.003450576683492393, 0.0012498565543945016, 0.003591583296012698, 0.0012442133942104823, 0.0034519434031350022, 0.0006986910334826068, 0.0005633854798386799, 0.002446950323411396, 0.0012501494110788935, 0.0012442133942104814, 0.0024478378851333733, 0.0005714517595093909, 0.0005635442380071057, 0.003454276673683742, 0.00048666991572018757, 0.0034519434031350014, 0.0005714517595093923, 0.0006952958442137402, 0.0015016509772126359, 0.001498084424261751, 0.000698691033482607, 0.00027966403492048745, 0.0037192227637753376, 0.0002788983594891035, 0.0008175769953356918, 0.000816493907060355, 0.0001809651367738606, 0.00017370145159553731, 0.000817612813884514, 0.00032167946513802473, 0.0007611606563492585, 0.0005293377743326017, 0.0007607367670355413, 0.0003210551371783285, 0.0008175769953356912, 0.0001738139407483547, 0.0008176128138845142, 0.0038849780700279625, 0.001799385330731024, 0.003260074718140841, 0.0032612040139946897, 0.0018016954038709663, 0.0038862841186336513, 0.0008164939070603555, 0.0003216794651380249, 0.0017993853307310232, 0.0006109481849694085, 0.0017445915617435857, 0.0006102346250692516, 0.001798934357657342, 0.0003202433341958461, 0.000761160656349259, 0.003260074718140842, 0.0017445915617435859, 0.0017416707680007297, 0.0032586209949611077, 0.0007624520778974549, 0.0005293377743326019, 0.0032612040139946906, 0.0006102346250692508, 0.0032586209949611073, 0.0005325173450359905, 0.0007607367670355426, 0.0018016954038709654, 0.0017989343576573422, 0.000762452077897455, 0.0003210551371783286, 0.003886284118633651, 0.0003202433341958468, 0.0008175769953356917, 0.000816493907060355, 0.0001738139407483549, 0.0001805886838167028, 0.000876465484298208, 0.0003959406206340581, 0.000710348677292154, 0.0007095880481058909, 0.00039448094251555074, 0.0008761879143686694, 0.00018096513677386076, 0.0008764654842982082, 0.004211444703710866, 0.0017742222860273429, 0.0043433059945773775, 0.001775437457636398, 0.004213029295981446, 0.0008755334542407336, 0.00039594062063405777, 0.0017742222860273429, 0.0007955444753029089, 0.0007960924550441117, 0.001774387063136056, 0.00039360251492831164, 0.0007103486772921539, 0.004343305994577379, 0.0007960924550441102, 0.004342426916392677, 0.0007089901675893073, 0.000709588048105891, 0.0017754374576363968, 0.001774387063136057, 0.0007089901675893074, 0.0003944809425155516, 0.004213029295981449, 0.0003936025149283117, 0.0008761879143686707, 0.0008755334542407342, 0.00018096513677386066, 0.00019251438196384024, 0.0009281072339859161, 0.00035045441425874584, 0.000920040398926978, 0.00034855233292138227, 0.0009274014227688575, 0.00019318310299553897, 0.0009281072339859157, 0.003808704813105778, 0.002104634035047987, 0.002105581189294956, 0.0038107997179438876, 0.0009274580262513286, 0.0003504544142587457, 0.002104634035047987, 0.00010837251159287348, 0.0021069747395662166, 0.0003477535824901507, 0.0009200403989269784, 0.002105581189294957, 0.0021069747395662183, 0.0009179755217450149, 0.00034855233292138346, 0.003810799717943889, 0.0003477535824901514, 0.0009274014227688578, 0.0009274580262513295, 0.0001931831029955391, 0.0001945575981195899, 0.0007979771562100563, 0.00039295752660037337, 0.0003916727375804203, 0.0007968969959757044, 0.0001953735518830034, 0.0007979771562100567, 0.00475312218085198, 0.0007915190273863138, 0.004755872848512797, 0.0007976534577020447, 0.0003929575266003725, 0.0007915190273863133, 0.0007948769833308143, 0.00039120965732456663, 0.00039167273758041984, 0.004755872848512795, 0.0003912096573245674, 0.0007968969959757036, 0.0007976534577020452, 0.00019537355188300383, 0.00015752446427736542, 0.0010163963459769848, 0.00012269359255873924, 0.0010153191058069008, 0.00015822702211080813, 0.0010163963459769853, 0.002324109939143952, 0.0023262128274969423, 0.0010163966008651909, 0.00012269359255873922, 0.002326212827496942, 0.00012266995922642122, 0.0010153191058069012, 0.001016396600865191, 0.00015822702211080807, 0.00021207676051802657, 0.0005250005861143468, 0.000524290447413585, 0.0002124030583581744, 0.0005250005861143482, 0.005700415641848584, 0.0005250826550155103, 0.0005242904474135862, 0.0005250826550155101, 0.00021240305835817455, 0.00010805612644433684, 0.0013067459436315071, 0.00010791678830417834, 0.001306745943631507, 0.00130662121654345, 0.00010791678830417828, 0.00026012553212702457, 0.00025978772780986596, 0.00025978772780986585, 1.9113495607837923e-5])
    cub_degree = 8
    tol = tol
  elseif q<=9 #1540 nodes /20 numedgenodes
    edgeparams = T[-1.0, -0.8947368421052633, -0.7894736842105263, -0.6842105263157894, -0.5789473684210527, -0.4736842105263159, -0.368421052631579, -0.2631578947368421, -0.1578947368421053, -0.05263157894736853, 0.05263157894736853, 0.1578947368421053, 0.2631578947368421, 0.368421052631579, 0.4736842105263159, 0.5789473684210527, 0.6842105263157894, 0.7894736842105263, 0.8947368421052633, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[5.72606032651381e-5, 0.0001614009849564534, 6.156416235202947e-5, 0.00014403116623267376, 0.00010818682554104255, 0.00011341999175777893, 0.00010462196154554525, 0.00010409718098901001, 0.00010938063608782888, 0.00011450882369630589, 0.00011448445988889113, 0.00010932144052249398, 0.00010403606713931733, 0.0001045912062869696, 0.00011342788372718805, 0.00010820876386971503, 0.00014402648728628286, 6.15234425422082e-5, 0.00016139516428695906, 5.730727662465689e-5, 0.0001614009849564536, 0.0006690422645020238, 0.0003037642679221526, 0.0006517284635040678, 0.0004778363750207626, 0.0005126496977401196, 0.0004959784322337114, 0.0005043254125889882, 0.0005200260357437493, 0.0005277417272656598, 0.0005200156887877208, 0.0005043245772377129, 0.0004960104636182394, 0.0005127169412147473, 0.00047790953537910546, 0.0006517540963716898, 0.00030371519463536943, 0.0006689735874146145, 0.00016140583156217992, 6.156416235202898e-5, 0.00030376426792215206, 0.00012843524869887515, 0.0002632533903021109, 0.0001797336358754133, 0.00020201260585714207, 0.00020059131282093638, 0.00020350311119084243, 0.0002054302054745731, 0.00020546724559281968, 0.00020359165265579227, 0.0002006780065313267, 0.00020204875753038475, 0.00017971277029785746, 0.00026322101607267363, 0.00012844251394760752, 0.00030377297696537335, 6.152129896556617e-5, 0.00014403116623267406, 0.0006517284635040664, 0.00026325339030211015, 0.0005321305450759907, 0.0003928708395568801, 0.0004556707952984149, 0.0004461169314103948, 0.0004318752565067266, 0.00042450619417132567, 0.0004319473428770477, 0.00044619563589047903, 0.0004556804609252389, 0.00039279809151153666, 0.0005320600498925653, 0.00026329128123432264, 0.0006518224768942203, 0.00014399358257104376, 0.00010818682554104276, 0.0004778363750207627, 0.00017973363587541375, 0.0003928708395568818, 0.0003145659315144684, 0.0003619489817234265, 0.00033742854926549487, 0.00031275876638394876, 0.00031278026157868907, 0.00033746448974643464, 0.000361943070636162, 0.0003145029973551452, 0.0003928213738922059, 0.0001797955202117716, 0.0004779526236702238, 0.00010815258220726451, 0.00011341999175777902, 0.0005126496977401195, 0.0002020126058571425, 0.00045567079529841613, 0.00036194898172342625, 0.0003970777100468022, 0.00036171290752688067, 0.00034464486695643466, 0.00036169765912205714, 0.0003970397376985542, 0.00036190104243385756, 0.0004556655862810946, 0.00020209739508474887, 0.0005127360079591293, 0.00011337324477068286, 0.00010462196154554502, 0.0004959784322337092, 0.00020059131282093522, 0.0004461169314103971, 0.00033742854926549503, 0.0003617129075268818, 0.0003335952730284078, 0.00033356071664620174, 0.00036163236840303824, 0.0003373599506765997, 0.0004461276092786888, 0.00020068916993689484, 0.0004960321025401212, 0.00010456077878430378, 0.00010409718098901113, 0.0005043254125889874, 0.000203503111190841, 0.0004318752565067253, 0.0003127587663839479, 0.00034464486695643526, 0.00033356071664620267, 0.00034454646630873955, 0.00031264851746523815, 0.0004318584699375486, 0.00020359278205258038, 0.0005043688235494589, 0.00010403676106501745, 0.00010938063608782884, 0.0005200260357437482, 0.00020543020547457387, 0.0004245061941713261, 0.0003127802615786891, 0.00036169765912205697, 0.000361632368403038, 0.0003126485174652381, 0.0004244432222918856, 0.00020549018984505554, 0.0005200810892126395, 0.00010934134062624262, 0.0001145088236963065, 0.0005277417272656606, 0.0002054672455928197, 0.00043194734287704866, 0.00033746448974643356, 0.00039703973769855634, 0.00033735995067660007, 0.00043185846993754924, 0.000205490189845057, 0.0005278108887318433, 0.0001145006956614119, 0.00011448445988889291, 0.0005200156887877213, 0.0002035916526557923, 0.0004461956358904805, 0.0003619430706361608, 0.000361901042433857, 0.0004461276092786885, 0.00020359278205258152, 0.0005200810892126408, 0.00011450069566141194, 0.00010932144052249156, 0.0005043245772377128, 0.00020067800653132654, 0.0004556804609252386, 0.00031450299735514246, 0.00045566558628109356, 0.00020068916993689552, 0.0005043688235494595, 0.00010934134062624274, 0.00010403606713931702, 0.0004960104636182377, 0.00020204875753038356, 0.0003927980915115355, 0.0003928213738922046, 0.0002020973950847473, 0.0004960321025401198, 0.00010403676106501729, 0.00010459120628696951, 0.0005127169412147461, 0.00017971277029785843, 0.0005320600498925659, 0.00017979552021176994, 0.0005127360079591275, 0.00010456077878430326, 0.00011342788372718911, 0.00047790953537910503, 0.00026322101607267634, 0.0002632912812343236, 0.00047795262367022416, 0.00011337324477068275, 0.00010820876386971639, 0.0006517540963716898, 0.00012844251394761002, 0.0006518224768942238, 0.00010815258220726575, 0.00014402648728628444, 0.0003037151946353669, 0.000303772976965372, 0.0001439935825710457, 6.152344254220751e-5, 0.0006689735874146017, 6.152129896556549e-5, 0.00016139516428695285, 0.00016140583156217385, 5.73072766246536e-5, 0.0001614009849564534, 0.0006690422645020229, 0.0003037642679221515, 0.0006517284635040665, 0.00047783637502076144, 0.0005126496977401196, 0.00049597843223371, 0.0005043254125889883, 0.0005200260357437485, 0.0005277417272656586, 0.00052001568878772, 0.0005043245772377116, 0.0004960104636182382, 0.0005127169412147468, 0.00047790953537910503, 0.0006517540963716874, 0.00030371519463536867, 0.0006689735874146137, 0.00016140583156217984, 0.0006690422645020234, 0.0031996544561953733, 0.0015567459765140291, 0.0029510389333037997, 0.00215824623003131, 0.002376448631215738, 0.0023553135043853195, 0.0023715028391976694, 0.002389927320633582, 0.002389910121317488, 0.002371453871883594, 0.002355238333529457, 0.0023763807557338847, 0.0021582378645228417, 0.0029511504882341333, 0.0015569570492676137, 0.0031997628964623775, 0.0006689532670858904, 0.0003037642679221518, 0.001556745976514023, 0.0006683834419930453, 0.0012045580409069938, 0.0009002658176608505, 0.0010645238694702297, 0.001048661820007518, 0.001001861967752077, 0.0009748490126260344, 0.0010018771285902918, 0.0010486208998786825, 0.001064357148279656, 0.0009000012305095785, 0.001204369912534935, 0.0006684559104085214, 0.001556964407335086, 0.00030372740857546497, 0.0006517284635040664, 0.0029510389333037962, 0.001204558040906993, 0.0024458283407310833, 0.0019099578721512827, 0.0021803618238875606, 0.0020782336622231965, 0.001973885887808736, 0.00197392268102044, 0.0020782954362476304, 0.0021803330374717284, 0.0019097573820062112, 0.0024455233299595512, 0.0012043574629820686, 0.0029511330082402205, 0.0006518022001407747, 0.00047783637502076296, 0.0021582462300313073, 0.0009002658176608531, 0.001909957872151284, 0.001568203625079377, 0.0017111770153492756, 0.0015484199551462914, 0.0014654961436814686, 0.0015484997253528351, 0.0017112790860332246, 0.001568225370593215, 0.0019097978448243539, 0.000899963792350543, 0.0021581372122645905, 0.00047797737484132875, 0.0005126496977401198, 0.0023764486312157366, 0.0010645238694702338, 0.0021803618238875615, 0.0017111770153492782, 0.0018009302328765185, 0.0016562198992510551, 0.0016562578634203844, 0.0018010527589040837, 0.0017113569629014843, 0.002180428079745523, 0.0010642957191039923, 0.0023761820337518703, 0.0005127929370424771, 0.000495978432233709, 0.002355313504385317, 0.0010486618200075167, 0.002078233662223197, 0.001548419955146291, 0.0016562198992510532, 0.0015892151478972538, 0.0016563083151729698, 0.0015486378378739962, 0.002078447398722264, 0.001048552416194175, 0.0023549570069924457, 0.0004960952551227878, 0.0005043254125889871, 0.0023715028391976677, 0.0010018619677520748, 0.0019738858878087335, 0.0014654961436814675, 0.0016562578634203848, 0.001656308315172972, 0.001465675050037747, 0.0019741205942347888, 0.0010018263550174002, 0.0023711442166672327, 0.0005044154954748, 0.0005200260357437484, 0.0023899273206335835, 0.0009748490126260345, 0.0019739226810204413, 0.0015484997253528375, 0.0018010527589040867, 0.001548637837873995, 0.0019741205942347905, 0.0009748222018891745, 0.0023895719645639466, 0.0005201065781701733, 0.0005277417272656606, 0.002389910121317488, 0.001001877128590294, 0.0020782954362476317, 0.0017112790860332242, 0.0017113569629014843, 0.0020784473987222655, 0.0010018263550174056, 0.0023895719645639483, 0.0005278272568218729, 0.000520015688787722, 0.0023714538718835956, 0.001048620899878683, 0.002180333037471728, 0.0015682253705932145, 0.00218042807974552, 0.0010485524161941765, 0.0023711442166672375, 0.0005201065781701747, 0.000504324577237713, 0.002355238333529456, 0.001064357148279655, 0.0019097573820062107, 0.0019097978448243496, 0.0010642957191039873, 0.002354957006992447, 0.0005044154954748013, 0.0004960104636182373, 0.002376380755733881, 0.0009000012305095789, 0.0024455233299595486, 0.0008999637923505391, 0.002376182033751866, 0.0004960952551227873, 0.0005127169412147458, 0.0021582378645228378, 0.0012043699125349385, 0.0012043574629820712, 0.0021581372122645884, 0.0005127929370424759, 0.00047790953537910525, 0.0029511504882341324, 0.0006684559104085268, 0.002951133008240227, 0.00047797737484133026, 0.000651754096371691, 0.0015569570492676068, 0.0015569644073350837, 0.0006518022001407779, 0.00030371519463536693, 0.0031997628964623454, 0.0003037274085754647, 0.0006689735874146018, 0.0006689532670858784, 0.00016140583156217374, 6.156416235202892e-5, 0.0003037642679221516, 0.00012843524869887444, 0.0002632533903021104, 0.000179733635875413, 0.0002020126058571414, 0.00020059131282093532, 0.00020350311119084216, 0.0002054302054745733, 0.0002054672455928195, 0.00020359165265579164, 0.0002006780065313273, 0.00020204875753038505, 0.0001797127702978584, 0.0002632210160726732, 0.00012844251394760755, 0.00030377297696537254, 6.152129896556576e-5, 0.0003037642679221526, 0.0015567459765140263, 0.000668383441993048, 0.0012045580409069951, 0.0009002658176608516, 0.001064523869470231, 0.001048661820007517, 0.0010018619677520761, 0.0009748490126260354, 0.001001877128590292, 0.001048620899878682, 0.0010643571482796571, 0.0009000012305095804, 0.0012043699125349353, 0.0006684559104085238, 0.001556964407335089, 0.00030372740857546594, 0.00012843524869887428, 0.0006683834419930415, 4.182465758935075e-5, 0.00028960952025110275, 0.000294160803837319, 0.0004245707983145869, 0.0003353035525965551, 0.0002175238932206833, 0.0002175336307545166, 0.0003353464408198812, 0.00042466441063475265, 0.00029428130707265633, 0.00028967504184582697, 4.176965181766378e-5, 0.0006682900448864844, 0.0001284520634255719, 0.00026325339030211004, 0.0012045580409069897, 0.000289609520251102, 0.0009532162633842862, 0.0008438633667338092, 0.0009381051277270242, 0.0007601317262560719, 0.0006636321827144587, 0.0007601452910946534, 0.0009382964510844758, 0.0008443173162013129, 0.0009536746058398551, 0.00028962487995280966, 0.0012041724297348637, 0.0002633016293421255, 0.00017973363587541426, 0.0009002658176608513, 0.000294160803837324, 0.000843863366733812, 0.0007395880366759249, 0.0007124744073545307, 0.0005419944086036532, 0.0005419113101977002, 0.0007124390926543003, 0.0007399480426258003, 0.0008445006840599651, 0.000294400365705676, 0.0008998496028570772, 0.0001798105786966035, 0.00020201260585714305, 0.0010645238694702325, 0.00042457079831459025, 0.0009381051277270277, 0.00071247440735453, 0.0006951731960603243, 0.0006186676743515047, 0.0006949423971449611, 0.0007125082510556182, 0.0009386283758497167, 0.00042499150315948185, 0.001064262695557071, 0.00020210567399680924, 0.00020059131282093522, 0.0010486618200075148, 0.00033530355259655495, 0.0007601317262560705, 0.0005419944086036525, 0.0006186676743515043, 0.0006185067359006489, 0.0005418519179090818, 0.0007604686591854384, 0.00033579025898353436, 0.0010485605227185532, 0.00020067290827869799, 0.00020350311119084143, 0.001001861967752074, 0.00021752389322068322, 0.0006636321827144594, 0.0005419113101977003, 0.0006949423971449614, 0.0005418519179090828, 0.0006639005756649673, 0.00021800778933768936, 0.0010018409160516585, 0.00020354374773517753, 0.00020543020547457278, 0.0009748490126260336, 0.00021753363075451636, 0.0007601452910946553, 0.0007124390926543012, 0.0007125082510556194, 0.0007604686591854404, 0.0002180077893376916, 0.0009748345189835943, 0.00020541800367097454, 0.00020546724559281985, 0.001001877128590292, 0.0003353464408198835, 0.0009382964510844781, 0.000739948042625799, 0.0009386283758497135, 0.0003357902589835367, 0.0010018409160516637, 0.00020541800367097587, 0.0002035916526557927, 0.0010486208998786825, 0.00042466441063475314, 0.000844317316201313, 0.0008445006840599612, 0.00042499150315947914, 0.0010485605227185568, 0.00020354374773517894, 0.00020067800653132732, 0.0010643571482796532, 0.00029428130707265715, 0.0009536746058398531, 0.00029440036570567185, 0.0010642626955570703, 0.00020067290827869774, 0.00020204875753038334, 0.0009000012305095779, 0.000289675041845828, 0.00028962487995281145, 0.0008998496028570763, 0.0002021056739968089, 0.0001797127702978579, 0.0012043699125349357, 4.176965181767089e-5, 0.0012041724297348682, 0.00017981057869660385, 0.000263221016072676, 0.0006684559104085239, 0.0006682900448864892, 0.00026330162934212823, 0.00012844251394761034, 0.001556964407335081, 0.00012845206342557418, 0.0003037729769653721, 0.00030372740857546323, 6.152129896556474e-5, 0.0001440311662326742, 0.0006517284635040665, 0.00026325339030211037, 0.0005321305450759903, 0.00039287083955688123, 0.0004556707952984147, 0.00044611693141039573, 0.0004318752565067255, 0.0004245061941713255, 0.0004319473428770472, 0.00044619563589047876, 0.00045568046092523903, 0.00039279809151153574, 0.0005320600498925652, 0.000263291281234322, 0.0006518224768942208, 0.0001439935825710439, 0.0006517284635040673, 0.0029510389333037945, 0.0012045580409069947, 0.0024458283407310846, 0.001909957872151283, 0.00218036182388756, 0.002078233662223198, 0.0019738858878087344, 0.00197392268102044, 0.0020782954362476313, 0.0021803330374717293, 0.0019097573820062131, 0.002445523329959551, 0.0012043574629820714, 0.002951133008240222, 0.0006518022001407749, 0.0002632533903021098, 0.0012045580409069886, 0.0002896095202511025, 0.0009532162633842851, 0.000843863366733809, 0.0009381051277270262, 0.0007601317262560707, 0.0006636321827144601, 0.0007601452910946539, 0.0009382964510844763, 0.0008443173162013139, 0.0009536746058398548, 0.00028962487995280907, 0.0012041724297348632, 0.0002633016293421253, 0.0005321305450759897, 0.0024458283407310802, 0.0009532162633842865, 0.0022222420585088242, 0.001748007114953951, 0.0018410704820861147, 0.0016517649731659586, 0.0016515448560555106, 0.0018407646346631683, 0.0017482269282816394, 0.002223013917909733, 0.0009537132967805728, 0.00244537243017921, 0.0005320933544520034, 0.0003928708395568822, 0.001909957872151283, 0.0008438633667338118, 0.0017480071149539517, 0.001337483914302434, 0.0013662772475012614, 0.0012712485898871745, 0.0013653087183644816, 0.0013366322147461524, 0.0017482107205037344, 0.0008445511025823488, 0.001909808573030843, 0.0003928023256452905, 0.0004556707952984145, 0.002180361823887561, 0.000938105127727028, 0.0018410704820861158, 0.0013662772475012614, 0.0014993877139765279, 0.001498546506955862, 0.0013646294289660574, 0.0018403323480416928, 0.0009385595158071803, 0.002180574796639361, 0.0004556133042967855, 0.00044611693141039514, 0.002078233662223196, 0.0007601317262560707, 0.0016517649731659593, 0.001271248589887175, 0.0014985465069558624, 0.0012696884562717443, 0.001650480942236862, 0.0007602406643879672, 0.0020786661983988883, 0.000446058402139855, 0.00043187525650672566, 0.001973885887808734, 0.0006636321827144595, 0.0016515448560555114, 0.001365308718364482, 0.0013646294289660578, 0.0016504809422368608, 0.000663601935052687, 0.001974347308924364, 0.0004317817971775454, 0.00042450619417132616, 0.0019739226810204405, 0.0007601452910946559, 0.001840764634663169, 0.0013366322147461518, 0.0018403323480416908, 0.0007602406643879682, 0.0019743473089243652, 0.0004243651784545106, 0.00043194734287704855, 0.002078295436247632, 0.0009382964510844771, 0.00174822692828164, 0.0017482107205037318, 0.0009385595158071784, 0.002078666198398891, 0.0004317817971775461, 0.00044619563589047936, 0.002180333037471729, 0.0008443173162013139, 0.0022230139179097307, 0.0008445511025823454, 0.0021805747966393615, 0.000446058402139855, 0.0004556804609252385, 0.0019097573820062107, 0.0009536746058398535, 0.0009537132967805724, 0.0019098085730308398, 0.0004556133042967845, 0.000392798091511536, 0.0024455233299595486, 0.00028962487995281135, 0.002445372430179211, 0.0003928023256452896, 0.0005320600498925664, 0.001204357462982074, 0.001204172429734866, 0.0005320933544520042, 0.00026329128123432394, 0.0029511330082402257, 0.0002633016293421281, 0.0006518224768942231, 0.0006518022001407768, 0.00014399358257104523, 0.00010818682554104276, 0.00047783637502076155, 0.00017973363587541356, 0.00039287083955688156, 0.00031456593151446826, 0.0003619489817234268, 0.00033742854926549433, 0.0003127587663839477, 0.00031278026157868896, 0.00033746448974643307, 0.0003619430706361615, 0.0003145029973551436, 0.00039282137389220524, 0.00017979552021177083, 0.0004779526236702231, 0.00010815258220726435, 0.00047783637502076253, 0.0021582462300313095, 0.0009002658176608526, 0.0019099578721512842, 0.0015682036250793782, 0.0017111770153492752, 0.001548419955146292, 0.001465496143681469, 0.0015484997253528343, 0.0017112790860332246, 0.0015682253705932158, 0.0019097978448243535, 0.0008999637923505426, 0.0021581372122645897, 0.0004779773748413286, 0.00017973363587541318, 0.000900265817660849, 0.0002941608038373202, 0.0008438633667338098, 0.0007395880366759253, 0.00071247440735453, 0.0005419944086036527, 0.0005419113101977003, 0.0007124390926543005, 0.0007399480426257994, 0.0008445006840599635, 0.000294400365705674, 0.0008998496028570759, 0.00017981057869660352, 0.0003928708395568816, 0.0019099578721512806, 0.0008438633667338111, 0.0017480071149539509, 0.0013374839143024343, 0.0013662772475012614, 0.0012712485898871745, 0.0013653087183644805, 0.0013366322147461524, 0.0017482107205037338, 0.0008445511025823479, 0.0019098085730308407, 0.00039280232564529007, 0.000314565931514469, 0.0015682036250793787, 0.0007395880366759274, 0.0013374839143024352, 0.0010260204171843338, 0.0010987929546675689, 0.0010975296974700618, 0.0010234917933217504, 0.001335986664002925, 0.0007398795656329399, 0.001568514002033507, 0.0003144337020139644, 0.0003619489817234267, 0.0017111770153492754, 0.0007124744073545311, 0.0013662772475012623, 0.00109879295466757, 0.0012519407305574494, 0.0010958123880303262, 0.0013633214728045516, 0.0007118484672564714, 0.00171177808777197, 0.00036182390793790395, 0.00033742854926549476, 0.0015484199551462896, 0.0005419944086036532, 0.0012712485898871743, 0.0010975296974700616, 0.0010958123880303267, 0.0012680390792874944, 0.0005407301797567319, 0.0015490934267982069, 0.00033731509804155933, 0.00031275876638394746, 0.0014654961436814677, 0.000541911310197701, 0.0013653087183644818, 0.001023491793321751, 0.0013633214728045523, 0.0005407301797567321, 0.0014661130242941715, 0.00031263478467513027, 0.00031278026157869026, 0.0015484997253528358, 0.0007124390926543022, 0.0013366322147461526, 0.001335986664002924, 0.00071184846725647, 0.0015490934267982088, 0.00031263478467513184, 0.0003374644897464337, 0.001711279086033225, 0.0007399480426258001, 0.0017482107205037325, 0.0007398795656329371, 0.0017117780877719706, 0.00033731509804155944, 0.0003619430706361604, 0.0015682253705932147, 0.0008445006840599636, 0.0008445511025823459, 0.0015685140020335064, 0.00036182390793790286, 0.0003145029973551438, 0.0019097978448243509, 0.0002944003657056734, 0.0019098085730308405, 0.00031443370201396327, 0.0003928213738922041, 0.0008999637923505388, 0.0008998496028570766, 0.00039280232564529083, 0.0001797955202117712, 0.0021581372122645875, 0.0001798105786966041, 0.0004779526236702241, 0.00047797737484132945, 0.0001081525822072656, 0.00011341999175777862, 0.0005126496977401192, 0.00020201260585714237, 0.00045567079529841434, 0.00036194898172342663, 0.00039707771004680225, 0.0003617129075268811, 0.0003446448669564353, 0.00036169765912205676, 0.0003970397376985556, 0.00036190104243385653, 0.0004556655862810957, 0.00020209739508474775, 0.0005127360079591279, 0.00011337324477068255, 0.0005126496977401205, 0.002376448631215736, 0.0010645238694702332, 0.002180361823887563, 0.0017111770153492754, 0.00180093023287652, 0.001656219899251056, 0.001656257863420384, 0.0018010527589040844, 0.001711356962901484, 0.002180428079745523, 0.0010642957191039928, 0.00237618203375187, 0.0005127929370424769, 0.0002020126058571422, 0.0010645238694702297, 0.00042457079831458776, 0.0009381051277270266, 0.00071247440735453, 0.0006951731960603237, 0.0006186676743515034, 0.0006949423971449604, 0.0007125082510556182, 0.0009386283758497151, 0.00042499150315947995, 0.0010642626955570686, 0.00020210567399680984, 0.0004556707952984145, 0.0021803618238875615, 0.0009381051277270273, 0.001841070482086115, 0.0013662772475012616, 0.0014993877139765283, 0.0014985465069558622, 0.0013646294289660576, 0.001840332348041691, 0.0009385595158071794, 0.0021805747966393597, 0.0004556133042967837, 0.000361948981723427, 0.001711177015349276, 0.0007124744073545308, 0.0013662772475012607, 0.0010987929546675695, 0.00125194073055745, 0.0010958123880303262, 0.001363321472804552, 0.0007118484672564707, 0.00171177808777197, 0.00036182390793790264, 0.00039707771004680235, 0.00180093023287652, 0.0006951731960603235, 0.0014993877139765279, 0.0012519407305574498, 0.0013750288590413987, 0.001495395807816091, 0.0006932863540933095, 0.0018015993687605142, 0.0003969684415313662, 0.00036171290752688105, 0.0016562198992510545, 0.0006186676743515039, 0.001498546506955863, 0.001095812388030326, 0.0014953958078160906, 0.0006163649543631334, 0.0016568328287118606, 0.00036164109700057554, 0.0003446448669564354, 0.0016562578634203838, 0.0006949423971449613, 0.0013646294289660578, 0.001363321472804551, 0.000693286354093308, 0.0016568328287118604, 0.00034459240322557897, 0.0003616976591220567, 0.0018010527589040848, 0.0007125082510556185, 0.0018403323480416902, 0.0007118484672564691, 0.001801599368760514, 0.00036164109700057473, 0.000397039737698556, 0.0017113569629014843, 0.0009386283758497144, 0.0009385595158071785, 0.0017117780877719702, 0.00039696844153136625, 0.00036190104243385794, 0.0021804280797455204, 0.00042499150315947936, 0.002180574796639362, 0.0003618239079379032, 0.0004556655862810964, 0.0010642957191039876, 0.0010642626955570697, 0.00045561330429678254, 0.00020209739508474748, 0.002376182033751866, 0.0002021056739968086, 0.0005127360079591274, 0.0005127929370424757, 0.00011337324477068273, 0.00010462196154554514, 0.0004959784322337093, 0.00020059131282093473, 0.0004461169314103947, 0.0003374285492654941, 0.000361712907526881, 0.0003335952730284067, 0.0003335607166462023, 0.0003616323684030369, 0.0003373599506765991, 0.00044612760927868853, 0.00020068916993689484, 0.0004960321025401209, 0.00010456077878430354, 0.0004959784322337093, 0.0023553135043853156, 0.0010486618200075176, 0.002078233662223197, 0.0015484199551462914, 0.001656219899251055, 0.001589215147897253, 0.0016563083151729706, 0.0015486378378739949, 0.0020784473987222637, 0.0010485524161941752, 0.002354957006992447, 0.0004960952551227882, 0.00020059131282093495, 0.0010486618200075157, 0.00033530355259655474, 0.0007601317262560707, 0.0005419944086036513, 0.0006186676743515036, 0.0006185067359006484, 0.0005418519179090823, 0.0007604686591854387, 0.00033579025898353463, 0.0010485605227185525, 0.000200672908278698, 0.0004461169314103949, 0.002078233662223195, 0.0007601317262560712, 0.0016517649731659578, 0.001271248589887173, 0.0014985465069558615, 0.0012696884562717432, 0.0016504809422368608, 0.0007602406643879669, 0.002078666198398888, 0.0004460584021398552, 0.00033742854926549487, 0.0015484199551462911, 0.0005419944086036528, 0.0012712485898871736, 0.0010975296974700612, 0.0010958123880303262, 0.0012680390792874931, 0.0005407301797567318, 0.0015490934267982069, 0.000337315098041559, 0.00036171290752688094, 0.001656219899251054, 0.0006186676743515045, 0.0014985465069558622, 0.0010958123880303267, 0.0014953958078160903, 0.0006163649543631333, 0.0016568328287118598, 0.00036164109700057527, 0.00033359527302840653, 0.001589215147897253, 0.0006185067359006481, 0.0012696884562717436, 0.0012680390792874938, 0.0006163649543631331, 0.0015897787399417522, 0.00033359090029706626, 0.0003335607166462024, 0.0016563083151729704, 0.0005418519179090822, 0.00165048094223686, 0.0005407301797567309, 0.00165683282871186, 0.00033359090029706697, 0.00036163236840303835, 0.0015486378378739955, 0.0007604686591854385, 0.0007602406643879665, 0.0015490934267982069, 0.0003616410970005755, 0.0003373599506765998, 0.0020784473987222637, 0.00033579025898353507, 0.002078666198398889, 0.0003373150980415599, 0.00044612760927868907, 0.0010485524161941743, 0.001048560522718555, 0.00044605840213985553, 0.00020068916993689451, 0.002354957006992446, 0.0002006729082786987, 0.0004960321025401198, 0.0004960952551227873, 0.00010456077878430347, 0.00010409718098901096, 0.0005043254125889872, 0.00020350311119084237, 0.0004318752565067254, 0.0003127587663839479, 0.00034464486695643537, 0.00033356071664620185, 0.0003445464663087394, 0.0003126485174652379, 0.00043185846993754805, 0.00020359278205257932, 0.0005043688235494591, 0.00010403676106501754, 0.000504325412588988, 0.002371502839197669, 0.001001861967752076, 0.0019738858878087357, 0.0014654961436814684, 0.0016562578634203842, 0.0016563083151729702, 0.001465675050037746, 0.0019741205942347896, 0.0010018263550174026, 0.002371144216667233, 0.0005044154954748004, 0.00020350311119084189, 0.0010018619677520752, 0.0002175238932206835, 0.0006636321827144587, 0.0005419113101976986, 0.0006949423971449594, 0.0005418519179090826, 0.0006639005756649663, 0.00021800778933769058, 0.00100184091605166, 0.0002035437477351776, 0.0004318752565067249, 0.0019738858878087335, 0.000663632182714459, 0.0016515448560555097, 0.0013653087183644803, 0.0013646294289660567, 0.0016504809422368608, 0.0006636019350526866, 0.0019743473089243635, 0.0004317817971775457, 0.0003127587663839477, 0.0014654961436814681, 0.0005419113101976996, 0.0013653087183644805, 0.0010234917933217506, 0.0013633214728045512, 0.0005407301797567316, 0.0014661130242941717, 0.00031263478467513027, 0.00034464486695643526, 0.0016562578634203848, 0.0006949423971449596, 0.0013646294289660578, 0.0013633214728045505, 0.0006932863540933086, 0.0016568328287118598, 0.000344592403225579, 0.0003335607166462021, 0.0016563083151729698, 0.0005418519179090816, 0.0016504809422368601, 0.0005407301797567309, 0.0016568328287118596, 0.00033359090029706686, 0.0003445464663087395, 0.0014656750500377457, 0.000663900575664965, 0.0006636019350526844, 0.001466113024294171, 0.00034459240322557924, 0.00031264851746523825, 0.0019741205942347896, 0.0002180077893376898, 0.0019743473089243644, 0.00031263478467513157, 0.000431858469937549, 0.0010018263550174032, 0.0010018409160516622, 0.00043178179717754674, 0.00020359278205258076, 0.002371144216667235, 0.00020354374773517907, 0.0005043688235494598, 0.0005044154954748012, 0.00010403676106501719, 0.0001093806360878285, 0.0005200260357437488, 0.00020543020547457338, 0.00042450619417132567, 0.0003127802615786893, 0.0003616976591220566, 0.0003616323684030376, 0.00031264851746523793, 0.0004244432222918849, 0.0002054901898450566, 0.0005200810892126397, 0.00010934134062624258, 0.0005200260357437489, 0.002389927320633583, 0.0009748490126260344, 0.0019739226810204396, 0.001548499725352835, 0.001801052758904085, 0.001548637837873996, 0.0019741205942347896, 0.0009748222018891745, 0.002389571964563946, 0.0005201065781701734, 0.0002054302054745727, 0.000974849012626033, 0.00021753363075451677, 0.0007601452910946544, 0.0007124390926543008, 0.0007125082510556171, 0.0007604686591854388, 0.00021800778933769077, 0.0009748345189835936, 0.0002054180036709746, 0.0004245061941713251, 0.001973922681020441, 0.0007601452910946553, 0.001840764634663168, 0.0013366322147461516, 0.0018403323480416906, 0.0007602406643879675, 0.001974347308924364, 0.00042436517845451045, 0.0003127802615786897, 0.0015484997253528358, 0.0007124390926543019, 0.0013366322147461529, 0.0013359866640029233, 0.0007118484672564698, 0.0015490934267982073, 0.00031263478467513157, 0.00036169765912205714, 0.0018010527589040854, 0.0007125082510556182, 0.001840332348041691, 0.0007118484672564695, 0.0018015993687605142, 0.0003616410970005763, 0.0003616323684030372, 0.0015486378378739946, 0.0007604686591854379, 0.0007602406643879661, 0.0015490934267982067, 0.00036164109700057527, 0.0003126485174652375, 0.0019741205942347883, 0.0002180077893376891, 0.0019743473089243626, 0.00031263478467513157, 0.0004244432222918842, 0.0009748222018891736, 0.000974834518983594, 0.0004243651784545117, 0.00020549018984505725, 0.002389571964563948, 0.00020541800367097546, 0.0005200810892126411, 0.0005201065781701745, 0.00010934134062624289, 0.00011450882369630636, 0.0005277417272656598, 0.00020546724559281974, 0.0004319473428770477, 0.0003374644897464336, 0.0003970397376985559, 0.00033735995067660007, 0.0004318584699375493, 0.00020549018984505706, 0.0005278108887318424, 0.00011450069566141159, 0.0005277417272656597, 0.0023899101213174854, 0.0010018771285902918, 0.0020782954362476317, 0.0017112790860332248, 0.0017113569629014847, 0.0020784473987222646, 0.0010018263550174039, 0.0023895719645639466, 0.0005278272568218726, 0.00020546724559281968, 0.001001877128590291, 0.00033534644081988183, 0.0009382964510844768, 0.000739948042625799, 0.0009386283758497137, 0.0003357902589835349, 0.001001840916051662, 0.00020541800367097443, 0.00043194734287704736, 0.0020782954362476296, 0.0009382964510844771, 0.0017482269282816407, 0.0017482107205037322, 0.0009385595158071784, 0.002078666198398889, 0.00043178179717754577, 0.00033746448974643367, 0.0017112790860332248, 0.0007399480426258001, 0.0017482107205037329, 0.0007398795656329381, 0.0017117780877719704, 0.00033731509804155933, 0.00039703973769855634, 0.0017113569629014845, 0.0009386283758497146, 0.0009385595158071792, 0.00171177808777197, 0.00039696844153136636, 0.0003373599506765993, 0.002078447398722262, 0.0003357902589835341, 0.0020786661983988874, 0.0003373150980415593, 0.0004318584699375485, 0.0010018263550174015, 0.00100184091605166, 0.00043178179717754636, 0.00020549018984505625, 0.002389571964563947, 0.00020541800367097516, 0.0005278108887318437, 0.0005278272568218737, 0.00011450069566141224, 0.00011448445988889285, 0.0005200156887877213, 0.00020359165265579227, 0.00044619563589047903, 0.0003619430706361613, 0.00036190104243385713, 0.00044612760927868896, 0.00020359278205257962, 0.0005200810892126406, 0.00011450069566141171, 0.0005200156887877212, 0.0023714538718835956, 0.0010486208998786819, 0.0021803330374717276, 0.0015682253705932142, 0.0021804280797455204, 0.0010485524161941743, 0.002371144216667235, 0.0005201065781701737, 0.00020359165265579286, 0.00104862089987868, 0.00042466441063475157, 0.0008443173162013136, 0.0008445006840599613, 0.00042499150315947746, 0.0010485605227185549, 0.0002035437477351778, 0.00044619563589047887, 0.002180333037471728, 0.0008443173162013147, 0.0022230139179097315, 0.0008445511025823451, 0.0021805747966393615, 0.0004460584021398554, 0.0003619430706361613, 0.0015682253705932147, 0.0008445006840599639, 0.0008445511025823465, 0.001568514002033507, 0.0003618239079379029, 0.00036190104243385816, 0.00218042807974552, 0.00042499150315947925, 0.0021805747966393623, 0.0003618239079379033, 0.000446127609278689, 0.0010485524161941726, 0.001048560522718553, 0.0004460584021398548, 0.00020359278205258003, 0.0023711442166672336, 0.0002035437477351778, 0.0005200810892126404, 0.0005201065781701743, 0.00011450069566141203, 0.00010932144052249158, 0.0005043245772377126, 0.00020067800653132735, 0.00045568046092523784, 0.0003145029973551436, 0.0004556655862810944, 0.00020068916993689498, 0.0005043688235494597, 0.00010934134062624272, 0.0005043245772377117, 0.002355238333529454, 0.0010643571482796548, 0.0019097573820062103, 0.0019097978448243496, 0.0010642957191039873, 0.0023549570069924487, 0.0005044154954748011, 0.00020067800653132667, 0.001064357148279652, 0.00029428130707265606, 0.000953674605839852, 0.0002944003657056706, 0.0010642626955570682, 0.00020067290827869753, 0.00045568046092523827, 0.0019097573820062092, 0.0009536746058398536, 0.0009537132967805713, 0.0019098085730308396, 0.0004556133042967839, 0.00031450299735514376, 0.0019097978448243509, 0.00029440036570567435, 0.001909808573030842, 0.0003144337020139628, 0.000455665586281096, 0.0010642957191039882, 0.0010642626955570697, 0.0004556133042967831, 0.0002006891699368942, 0.002354957006992445, 0.00020067290827869796, 0.0005043688235494591, 0.0005044154954748004, 0.00010934134062624273, 0.00010403606713931713, 0.0004960104636182382, 0.00020204875753038434, 0.00039279809151153585, 0.00039282137389220405, 0.00020209739508474756, 0.0004960321025401205, 0.00010403676106501742, 0.0004960104636182382, 0.0023763807557338813, 0.0009000012305095784, 0.002445523329959548, 0.0008999637923505375, 0.0023761820337518673, 0.0004960952551227879, 0.0002020487575303838, 0.0009000012305095758, 0.00028967504184582545, 0.0002896248799528078, 0.0008998496028570748, 0.00020210567399680886, 0.0003927980915115358, 0.0024455233299595473, 0.0002896248799528096, 0.0024453724301792103, 0.00039280232564529007, 0.00039282137389220464, 0.0008999637923505399, 0.0008998496028570779, 0.00039280232564529056, 0.0002020973950847475, 0.002376182033751867, 0.00020210567399680902, 0.000496032102540121, 0.0004960952551227879, 0.00010403676106501733, 0.00010459120628696983, 0.0005127169412147461, 0.00017971277029785805, 0.0005320600498925647, 0.00017979552021177013, 0.0005127360079591281, 0.00010456077878430365, 0.0005127169412147461, 0.00215823786452284, 0.0012043699125349357, 0.0012043574629820703, 0.0021581372122645875, 0.0005127929370424765, 0.00017971277029785795, 0.0012043699125349337, 4.176965181766527e-5, 0.0012041724297348632, 0.0001798105786966034, 0.0005320600498925653, 0.00120435746298207, 0.0012041724297348645, 0.0005320933544520032, 0.00017979552021177094, 0.002158137212264591, 0.00017981057869660415, 0.0005127360079591285, 0.0005127929370424769, 0.00010456077878430374, 0.00011342788372718881, 0.0004779095353791051, 0.00026322101607267456, 0.0002632912812343225, 0.000477952623670224, 0.00011337324477068278, 0.00047790953537910514, 0.0029511504882341307, 0.0006684559104085239, 0.0029511330082402257, 0.00047797737484132934, 0.0002632210160726745, 0.0006684559104085213, 0.0006682900448864847, 0.0002633016293421269, 0.0002632912812343226, 0.0029511330082402213, 0.00026330162934212693, 0.0004779526236702246, 0.00047797737484133, 0.00011337324477068294, 0.00010820876386971584, 0.0006517540963716879, 0.00012844251394760901, 0.0006518224768942223, 0.0001081525822072652, 0.0006517540963716889, 0.0015569570492676085, 0.001556964407335087, 0.0006518022001407765, 0.00012844251394760882, 0.0015569644073350833, 0.00012845206342557326, 0.000651822476894222, 0.000651802200140776, 0.00010815258220726537, 0.00014402648728628392, 0.0003037151946353683, 0.0003037729769653731, 0.00014399358257104487, 0.00030371519463536764, 0.0031997628964623636, 0.0003037274085754655, 0.00030377297696537297, 0.00030372740857546383, 0.0001439935825710448, 6.152344254220816e-5, 0.0006689735874146096, 6.1521298965566e-5, 0.0006689735874146093, 0.0006689532670858851, 6.152129896556568e-5, 0.00016139516428695667, 0.00016140583156217764, 0.00016140583156217764, 5.730727662465542e-5])
    cub_degree = 9
    tol = tol
  else
    error("polynomial degree must be <= 10 (presently)\n")
  end

  mask = Int64[]
  append!(mask, (cub.numparams+1):(cub.numparams+cub.numweights))
  vtx = T[-1 -1 -1; 1 -1 -1; -1 1 -1; -1 -1 1]
  CubatureB.solvecubature!(cub, cub_degree, mask, tol=tol, hist=false)
  return cub, vtx
end

"""
### Cubature.getTriCubatureForTetFaceDiagE{T}

Returns a cubature rule and vertices for facets of the SBP DiagE operators 
on tetrahedra; these should not be used for 2D problems as they do not 
satisfy the accruacy requirements along their edge.

**Inputs**

* `q`: maximum degree of polynomial for which the cubature is exact
* `T`: the data type used to represent the cubature
* `faceopertype`: the operator type on the facets of the tetrahedron
* `tol`: tolerance with which to solve the cubature

**Outputs**

* `cub`: a symmetric cubature for the right triangle
* `vtx`: vertices for the right triangle

"""
function getTriCubatureForTetFaceDiagE(q::Int, T=Float64; faceopertype::Symbol=:DiagE,
  tol=10*eps(typeof(real(one(T)))))
  cub_degree = q
  mask = zeros(Int64, (0))

  if q<=2 #10 nodes/4 edgenodes
    edgeparams = T[-1.0, -0.3333333333333334, 0.3333333333333334, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.0008897862174491342, 0.21427038546253185, 0.2429227997473184, 0.0032730487252983997, 0.28306025588512057, 0.5856136295802998, 0.24725805407678642, 0.17413292932472962, 0.20993513113306397, 0.03864397984740214])
    cub_degree = 2
    tol = tol
  elseif q<=4 #21 nodes/6 edgenodes
    edgeparams = T[-1.0, -0.6000000000000001, -0.19999999999999996, 0.19999999999999996, 0.6000000000000001, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.01405301085260322, 0.07421226594458286, 0.039494910545681924, 0.008069884472903587, 0.09821876891463416, 0.002813908119897692, 0.06385601312573413, 0.31860555957474895, 0.20452783716646553, 0.2854295998401005, 0.09604502381921051, 0.0602074161833794, 0.012008267915855502, 0.06177220751782839, 0.012417374663751, 0.0515305685854095, 0.41377597934050714, 0.08273263023771368, 0.04440183198327955, 0.028800801157127513, 0.027026140038585254])
    cub_degree = 4
    tol = tol
  elseif q<=6 #36 nodes/9 edgenodes
    edgeparams = T[-1.0, -0.7142857142857144, -0.4285714285714286, -0.14285714285714285, 0.14285714285714285, 0.4285714285714286, 0.7142857142857144, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.006638210623242855, 0.03460713926081095, 0.016318156847554097, 0.020961247356352748, 0.03953347590317501, 0.0049435612461134, 0.03815659194870146, 0.0061127992519540856, 0.03721242341352587, 0.20208196185113678, 0.0029791773968752856, 0.26843777362855503, 0.004135469763611696, 0.2035344369266753, 0.0373408503246568, 0.008502304389409352, 0.007903880938245737, 0.028074799578232005, 0.02576221484475858, 0.003116400882663202, 0.007390786118247466, 0.03234610027280378, 0.261871502240061, 0.02556113372515799, 0.2697965321364866, 0.03579445740993449, 0.029790190833847485, 0.00916071386478253, 0.0032169414424635615, 0.024360576222610314, 0.00978448346747577, 0.20148412306228683, 0.014231006718681955, 0.03688467018564542, 0.03540249576857672, 0.006571410154687816])
    cub_degree = 6
    tol = tol
    #45 nodes/9 edgenodes
    # edgeparams = T[-1.0, -0.75, -0.5, -0.25, 0.0, 0.25, 0.5, 0.75, 1.0]
    # cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    # AsymCubatures.setparams!(cub, edgeparams)
    # AsymCubatures.setweights!(cub, T[0.0033122018735757307, 0.033049307240491904, 0.007508668300795323, 0.020234933761505147, 0.026867834412453318, 0.02091334608062495, 0.004919153210444127, 0.03522488731837025, 0.0027325900975157355, 0.03347158945301112, 0.12199730585961518, 0.04868720571004308, 0.10339723261513774, 0.1040789224366535, 0.05402503496591255, 0.11771525674899373, 0.03446104649230194, 0.006285990704841751, 0.05278160746196037, 0.033032400216308475, 0.05571135775640743, 0.03296472604088432, 0.05115000610535941, 0.0072314248153100115, 0.020804868073712516, 0.10081632369769393, 0.05490139465766636, 0.03592571529620089, 0.10928101866562233, 0.017969488397157476, 0.02637814562060965, 0.10282171890104955, 0.03588829387051696, 0.10767757615489193, 0.028241608878267155, 0.022743155126460718, 0.05522934815464212, 0.050016206277713825, 0.01916634063820194, 0.0029403181369146037, 0.1174607589629692, 0.006538289830318002, 0.03610625655223602, 0.034809491077039054, 0.0025296533515988097])
    # cub_degree = 6
    # tol = tol
  elseif q<=8 #91 nodes/13 edgenodes
    edgeparams = T[-1.0, -0.8333333333333333, -0.6666666666666667, -0.5, -0.3333333333333334, -0.16666666666666674, 0.0, 0.16666666666666674, 0.3333333333333334, 0.5, 0.6666666666666667, 0.8333333333333333, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.0016775768661700878, 0.014235615638557853, 0.002336046478558619, 0.010563341637444316, 0.009088459535422477, 0.009065586089574544, 0.006498774902973724, 0.00809960122151133, 0.00933659022219629, 0.011136814968387705, 0.0017713289251305503, 0.01436836285604404, 0.0016983527576658662, 0.014372620566847375, 0.05822283465239315, 0.019071224764365447, 0.05503836998234735, 0.042972311628616165, 0.035300881216800646, 0.03643831453156096, 0.0422680059774604, 0.055883261635035666, 0.019261875608220604, 0.0582782774014568, 0.014163377587877089, 0.0019180026708970634, 0.019441767740877743, 0.0058551083874507975, 0.021050000925130836, 0.012644548141357832, 0.00880953269047014, 0.013416672640354026, 0.020078433419680655, 0.0032508627787065257, 0.020173780117562032, 0.0024038683180967134, 0.011051435541446651, 0.0549401556828132, 0.01901767354846502, 0.04431537427173223, 0.03423734516836988, 0.03830087342715686, 0.04400483712713546, 0.02196114968939618, 0.05520469495670148, 0.010000891013244745, 0.008851542668362872, 0.043340002092824285, 0.011837969313912062, 0.03385086320075272, 0.029273007909858855, 0.028890750602721473, 0.012083622126376073, 0.042407008284330944, 0.009479044881103554, 0.008895030737380284, 0.036795589259960515, 0.010663705121135958, 0.036878721819671695, 0.027968392441841853, 0.019044993679342148, 0.03356010594171712, 0.010036741937579594, 0.006215457085373045, 0.03477556919785566, 0.01385498418556331, 0.04491289095769954, 0.013054657624288953, 0.03547298657016348, 0.005001319393044213, 0.00879175043921862, 0.041827503193225105, 0.020927615853786278, 0.01999492316793032, 0.04194129086848053, 0.009008945042688427, 0.00894253104396505, 0.055218182763887555, 0.0032043815625310266, 0.055638881790277823, 0.010065596372605717, 0.011781825401426322, 0.020550345997940218, 0.020126460965903717, 0.01003594390127067, 0.000976707400762203, 0.057648179779319464, 0.0022141802806119955, 0.014767112112839893, 0.014353953487719166, 0.0016139156310853793])
    cub_degree = 8
    tol = tol
  elseif q<=10 #171 nodes/18 edgenodes
    edgeparams = T[-1.0, -0.8823529411764706, -0.7647058823529411, -0.6470588235294117, -0.5294117647058822, -0.41176470588235287, -0.2941176470588236, -0.17647058823529416, -0.05882352941176472, 0.05882352941176472, 0.17647058823529416, 0.2941176470588236, 0.41176470588235287, 0.5294117647058822, 0.6470588235294117, 0.7647058823529411, 0.8823529411764706, 1.0]
    cub = AsymCubatures.TriAsymCub{T}(numedgenodes=length(edgeparams))  
    AsymCubatures.setparams!(cub, edgeparams)
    AsymCubatures.setweights!(cub, T[0.0007509821196202235, 0.007302758388588854, 0.0013247524404740054, 0.004152119153893176, 0.005817277965524546, 0.0040159268126411535, 0.003895016980758349, 0.0027245739487663447, 0.005016350873177284, 0.005751062888664863, 0.0035573439467550282, 0.0025479610119303582, 0.004829815679182238, 0.005588186528058312, 0.004085643160701326, 0.0013088783729850997, 0.0072975762110719985, 0.0007982843989014975, 0.007490932905168272, 0.02764556062501695, 0.011653221384243304, 0.023858622638356308, 0.02491185895392844, 0.017371176125437548, 0.015321123209063564, 0.020470051782370328, 0.02565645059541974, 0.021559002544238513, 0.013712169182465012, 0.016824755574641664, 0.026077315141915042, 0.023913113171403762, 0.011701533818761805, 0.0277405035876622, 0.007190093574465824, 0.0009051387713402714, 0.011509297550840231, 0.003074357472483947, 0.009557970206023551, 0.010200182470171527, 0.00520213815740743, 0.0058813752236775005, 0.009957892677674962, 0.011780442059069519, 0.00694840881094902, 0.005531222373429016, 0.009578727113939832, 0.009990433872863124, 0.001565836207331636, 0.01217652403901382, 0.001449620774539636, 0.004551415350092029, 0.02477570015286422, 0.009392494087567975, 0.016275963259363986, 0.01754062616552936, 0.01563411270203011, 0.01467719519823168, 0.015099085440222496, 0.013060389427006889, 0.015993867739790397, 0.016072838569560557, 0.01593922500052763, 0.01102143637804114, 0.02338589571564851, 0.004087254267694499, 0.0051756311428014104, 0.02422329280238587, 0.010455290207103516, 0.016770839500212797, 0.017960354704793555, 0.017576969638862086, 0.014317379221261731, 0.014114086406550786, 0.017396466837863254, 0.020710120566492872, 0.01642092102050076, 0.01097558416769616, 0.02478642442208831, 0.00548540558342727, 0.005323684098811656, 0.016227388959246684, 0.005443930964036098, 0.014733065329660804, 0.018743146330067177, 0.012909192654775628, 0.008739987434804022, 0.011674717966788378, 0.0184278933559313, 0.014981494020680232, 0.004121637640286353, 0.017838012653513945, 0.004970044914877922, 0.0030982481555503305, 0.01626376034332076, 0.006627473433755068, 0.015138462704988816, 0.014834797401634828, 0.009183651269098411, 0.009009550361997269, 0.01411359979662114, 0.01358496263246974, 0.006687216404920878, 0.01438930840746171, 0.0025889730270651653, 0.0017580358878388285, 0.021846883082955123, 0.01038055113602574, 0.012556113173333876, 0.01312190977995253, 0.012903889770480115, 0.01453162767339263, 0.015565344390170379, 0.011097848290572096, 0.02103428081716425, 0.0035707563530035266, 0.006469478238264653, 0.023961403616623873, 0.011510677745414285, 0.015020191965715399, 0.01822137353498716, 0.017122490837605944, 0.014059819348027892, 0.011043406542584289, 0.024829751223734736, 0.005635657724537035, 0.005240520379858544, 0.01984124915307361, 0.007421395503377377, 0.01482012438047514, 0.01985958951653199, 0.015074227673454708, 0.006101004943521389, 0.022769555478451962, 0.004501795613643143, 0.004238614036506371, 0.015520295584867904, 0.006263707572524283, 0.01699056932342509, 0.016686119951529785, 0.0051035195772570815, 0.013087489627609796, 0.003654491410257381, 0.001595854444707817, 0.01781113887641826, 0.007206792941651359, 0.016608923510643563, 0.00993304532345232, 0.017836979653137332, 0.0033018415023457186, 0.004747848661396952, 0.025194212887026175, 0.010814434987489284, 0.01067850444156564, 0.025176940762406414, 0.004436483697747514, 0.006240195245037421, 0.02352094226394629, 0.0021762622325544527, 0.023804503738032532, 0.0054135005952692565, 0.003899623954645857, 0.012069775354996705, 0.01125548840599496, 0.004342857122629055, 0.0011764515083034248, 0.02790184615830433, 0.001405400890533272, 0.007345134975041015, 0.007200376600114905, 0.0007868489902744847])
    cub_degree = 10
    tol = tol
  else
    error("polynomial degree must be <= 10 (presently)\n")
  end
  mask = Int64[]
  append!(mask, (cub.numparams+1):(cub.numparams+cub.numweights))
  vtx = T[-1 -1; 1 -1; -1 1]
  Cubature.solvecubature!(cub, cub_degree, mask, tol=tol)
  return cub, vtx
end

"""
### CubatureB.quadratureGivenNodes{T}

This high-level function computes and returns a cubature rule on a given
set of nodes on the interval [-1,1]

**Inputs**

* `q`: maximum degree of polynomial for which the cubature is exact
* `nodes`: the nodal location
* `T`: the data type used to represent the cubature

**Outputs**

* `cub`: an asymmetric cubature for the interval [-1,1]
* `vtx`: vertices, [-1,1]

"""
function quadratureGivenNodes(q::Int, nodes::Array{Float64,1}, T=Float64; internal::Bool=false)
  @assert(length(nodes) >= q+1)

  numedge = length(nodes)
  quad = LineAsymCub{T}(numedgenodes=numedge)
   
  AsymCubatures.setparams!(quad, nodes)
  weight = (2.0/numedge)*ones(T, numedge)
  AsymCubatures.setweights!(quad, weight)
  solvecubatureweights!(quad, q)
  #mask = zeros(Int64, (0))
  #append!(mask, (quad.numparams+1):(quad.numparams+quad.numweights))
  #Cubature.solvecubature!(quad, q, mask, tol=1e-15)

  vtx = reshape(T[-1; 1], (2,1))
  return quad, vtx
end

end
